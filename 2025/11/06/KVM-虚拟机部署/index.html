<!DOCTYPE html><html lang="zh-CN" data-theme="dark"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>KVM è™šæ‹Ÿæœºéƒ¨ç½² | Dong_Blog</title><meta name="author" content="Mr.xu"><meta name="copyright" content="Mr.xu"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#0d0d0d"><meta name="description" content="ä»€ä¹ˆæ˜¯è™šæ‹ŸåŒ–:123vmmã€Hypervisor æ˜¯æä¾›çœŸæ­£è™šæ‹Ÿæœºç®¡ç†ç¨‹åºçš„ï¼Œ---åˆ›å»ºï¼Œåˆ é™¤-å¼€å…³æœºã€‚Hypervisoræ˜¯å±äºå†…æ ¸åŠŸèƒ½çš„ï¼Œæ“ä½œç³»ç»Ÿå†…æ ¸çš„ä¸€ä¸ªæ¨¡å—ã€‚æŠŠå’Œå†…æ ¸äº¤äº’çš„å·¥å…·ç§°ä¹‹ä¸ºç”¨æˆ·è‚½å·¥å…·ï¼šæ¯”å¦‚ï¼švirshå‘½ä»¤è¡Œã€virt-managerå›¾å½¢ç•Œé¢ï¼Œ  è™šæ‹ŸåŒ–äº§å“åˆ†ç±»:æ¡Œé¢çº§è™šæ‹ŸåŒ–ä¼ä¸šçº§è™šæ‹ŸæœºåŒ– è™šæ‹ŸåŒ–äº§å“åˆ†ç±»ï¼š123456781.Kvmï¼ˆredhat-----ä¼ä¸šçº§ï¼‰2.Vmware:">
<meta property="og:type" content="article">
<meta property="og:title" content="KVM è™šæ‹Ÿæœºéƒ¨ç½²">
<meta property="og:url" content="https://7dong.dpdns.org/2025/11/06/KVM-%E8%99%9A%E6%8B%9F%E6%9C%BA%E9%83%A8%E7%BD%B2/index.html">
<meta property="og:site_name" content="Dong_Blog">
<meta property="og:description" content="ä»€ä¹ˆæ˜¯è™šæ‹ŸåŒ–:123vmmã€Hypervisor æ˜¯æä¾›çœŸæ­£è™šæ‹Ÿæœºç®¡ç†ç¨‹åºçš„ï¼Œ---åˆ›å»ºï¼Œåˆ é™¤-å¼€å…³æœºã€‚Hypervisoræ˜¯å±äºå†…æ ¸åŠŸèƒ½çš„ï¼Œæ“ä½œç³»ç»Ÿå†…æ ¸çš„ä¸€ä¸ªæ¨¡å—ã€‚æŠŠå’Œå†…æ ¸äº¤äº’çš„å·¥å…·ç§°ä¹‹ä¸ºç”¨æˆ·è‚½å·¥å…·ï¼šæ¯”å¦‚ï¼švirshå‘½ä»¤è¡Œã€virt-managerå›¾å½¢ç•Œé¢ï¼Œ  è™šæ‹ŸåŒ–äº§å“åˆ†ç±»:æ¡Œé¢çº§è™šæ‹ŸåŒ–ä¼ä¸šçº§è™šæ‹ŸæœºåŒ– è™šæ‹ŸåŒ–äº§å“åˆ†ç±»ï¼š123456781.Kvmï¼ˆredhat-----ä¼ä¸šçº§ï¼‰2.Vmware:">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://7dong.dpdns.org/img/picture/28.jpg">
<meta property="article:published_time" content="2025-11-06T12:53:28.000Z">
<meta property="article:modified_time" content="2026-02-04T10:20:38.844Z">
<meta property="article:author" content="Mr.xu">
<meta property="article:tag" content="Linux">
<meta property="article:tag" content="KVM">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://7dong.dpdns.org/img/picture/28.jpg"><script type="application/ld+json">{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "KVM è™šæ‹Ÿæœºéƒ¨ç½²",
  "url": "https://7dong.dpdns.org/2025/11/06/KVM-%E8%99%9A%E6%8B%9F%E6%9C%BA%E9%83%A8%E7%BD%B2/",
  "image": "https://7dong.dpdns.org/img/picture/28.jpg",
  "datePublished": "2025-11-06T12:53:28.000Z",
  "dateModified": "2026-02-04T10:20:38.844Z",
  "author": [
    {
      "@type": "Person",
      "name": "Mr.xu",
      "url": "https://7dong.dpdns.org"
    }
  ]
}</script><link rel="shortcut icon" href="/img/dong.png"><link rel="canonical" href="https://7dong.dpdns.org/2025/11/06/KVM-%E8%99%9A%E6%8B%9F%E6%9C%BA%E9%83%A8%E7%BD%B2/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css?v=5.5.3"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@7.1.0/css/all.min.css"><script>
    (() => {
      
    const saveToLocal = {
      set: (key, value, ttl) => {
        if (!ttl) return
        const expiry = Date.now() + ttl * 86400000
        localStorage.setItem(key, JSON.stringify({ value, expiry }))
      },
      get: key => {
        const itemStr = localStorage.getItem(key)
        if (!itemStr) return undefined
        const { value, expiry } = JSON.parse(itemStr)
        if (Date.now() > expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return value
      }
    }

    window.btf = {
      saveToLocal,
      getScript: (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        Object.entries(attr).forEach(([key, val]) => script.setAttribute(key, val))
        script.onload = script.onreadystatechange = () => {
          if (!script.readyState || /loaded|complete/.test(script.readyState)) resolve()
        }
        script.onerror = reject
        document.head.appendChild(script)
      }),
      getCSS: (url, id) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onload = link.onreadystatechange = () => {
          if (!link.readyState || /loaded|complete/.test(link.readyState)) resolve()
        }
        link.onerror = reject
        document.head.appendChild(link)
      }),
      addGlobalFn: (key, fn, name = false, parent = window) => {
        if (!false && key.startsWith('pjax')) return
        const globalFn = parent.globalFn || {}
        globalFn[key] = globalFn[key] || {}
        globalFn[key][name || Object.keys(globalFn[key]).length] = fn
        parent.globalFn = globalFn
      }
    }
  
      
      const activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      const activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }

      btf.activateDarkMode = activateDarkMode
      btf.activateLightMode = activateLightMode

      const theme = saveToLocal.get('theme')
    
          theme === 'dark' ? activateDarkMode() : theme === 'light' ? activateLightMode() : null
        
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        document.documentElement.classList.toggle('hide-aside', asideStatus === 'hide')
      }
    
      
    const detectApple = () => {
      if (/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)) {
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
  
    })()
  </script><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: {"path":"/search.json","preload":false,"top_n_per_article":1,"unescape":false,"pagination":{"enable":false,"hitsPerPage":8},"languages":{"hits_empty":"æœªæ‰¾åˆ°ç¬¦åˆæ‚¨æŸ¥è¯¢çš„å†…å®¹ï¼š${query}","hits_stats":"å…±æ‰¾åˆ° ${hits} ç¯‡æ–‡ç« "}},
  translate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false,"highlightFullpage":false,"highlightMacStyle":false},
  copy: {
    success: 'å¤åˆ¶æˆåŠŸ',
    error: 'å¤åˆ¶å¤±è´¥',
    noSupport: 'æµè§ˆå™¨ä¸æ”¯æŒ'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  dateSuffix: {
    just: 'åˆšåˆš',
    min: 'åˆ†é’Ÿå‰',
    hour: 'å°æ—¶å‰',
    day: 'å¤©å‰',
    month: 'ä¸ªæœˆå‰'
  },
  copyright: undefined,
  lightbox: 'null',
  Snackbar: undefined,
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid@4.12.0/dist/infinitegrid.min.js',
    buttonText: 'åŠ è½½æ›´å¤š'
  },
  isPhotoFigcaption: false,
  islazyloadPlugin: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'KVM è™šæ‹Ÿæœºéƒ¨ç½²',
  isHighlightShrink: false,
  isToc: true,
  pageType: 'post'
}</script><link rel="stylesheet" href="/css/custom.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.css"><script src="https://cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.js"></script><script src="https://cdn.jsdelivr.net/npm/meting@2/dist/Meting.min.js"></script><meta name="generator" content="Hexo 7.3.0"></head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img text-center"><img src="/img/dong.png" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data text-center"><a href="/archives/"><div class="headline">æ–‡ç« </div><div class="length-num">82</div></a><a href="/tags/"><div class="headline">æ ‡ç­¾</div><div class="length-num">46</div></a><a href="/categories/"><div class="headline">åˆ†ç±»</div><div class="length-num">1</div></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> ä¸»é¡µ</span></a></div><div class="menus_item"><span class="site-page group"><i class="fa-fw fas fa-cogs"></i><span> æœåŠ¡</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" target="_blank" rel="noopener" href="https://cnb.cool/xubaodong/images/-/packages?type=docker&amp;ordering=last_push_at"><i class="fa-fw fas fa-docker"></i><span> é•œåƒ</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/links/"><i class="fa-fw fas fa-link"></i><span> å‹é“¾</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-user"></i><span> å…³äº</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url(/img/picture/28.jpg);"><nav id="nav"><span id="blog-info"><a id="site-name" href="/">ğŸ€Â <strong class="site-title-bold">ä¸œ</strong></a><a class="nav-page-title" href="/"><span class="site-name">KVM è™šæ‹Ÿæœºéƒ¨ç½²</span><span class="site-name"><i class="fa-solid fa-circle-arrow-left"></i><span>  è¿”å›é¦–é¡µ</span></span></a></span><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> ä¸»é¡µ</span></a></div><div class="menus_item"><span class="site-page group"><i class="fa-fw fas fa-cogs"></i><span> æœåŠ¡</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" target="_blank" rel="noopener" href="https://cnb.cool/xubaodong/images/-/packages?type=docker&amp;ordering=last_push_at"><i class="fa-fw fas fa-docker"></i><span> é•œåƒ</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/links/"><i class="fa-fw fas fa-link"></i><span> å‹é“¾</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-user"></i><span> å…³äº</span></a></div></div><div id="search-button"><span class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> æœç´¢</span></span></div><div id="toggle-menu"><span class="site-page"><i class="fas fa-bars fa-fw"></i></span></div></div></nav><div id="post-info"><h1 class="post-title">KVM è™šæ‹Ÿæœºéƒ¨ç½²</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">å‘è¡¨äº</span><time class="post-meta-date-created" datetime="2025-11-06T12:53:28.000Z" title="å‘è¡¨äº 2025-11-06 20:53:28">2025-11-06</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">æ›´æ–°äº</span><time class="post-meta-date-updated" datetime="2026-02-04T10:20:38.844Z" title="æ›´æ–°äº 2026-02-04 18:20:38">2026-02-04</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/operations/">operations</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title=""><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">æµè§ˆé‡:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="container post-content" id="article-container"><h2 id="ä»€ä¹ˆæ˜¯è™šæ‹ŸåŒ–"><a href="#ä»€ä¹ˆæ˜¯è™šæ‹ŸåŒ–" class="headerlink" title="ä»€ä¹ˆæ˜¯è™šæ‹ŸåŒ–:"></a>ä»€ä¹ˆæ˜¯è™šæ‹ŸåŒ–:</h2><figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">vmmã€Hypervisor æ˜¯æä¾›çœŸæ­£è™šæ‹Ÿæœºç®¡ç†ç¨‹åºçš„ï¼Œ---åˆ›å»ºï¼Œåˆ é™¤-å¼€å…³æœºã€‚</span><br><span class="line"></span><br><span class="line">Hypervisoræ˜¯å±äºå†…æ ¸åŠŸèƒ½çš„ï¼Œæ“ä½œç³»ç»Ÿå†…æ ¸çš„ä¸€ä¸ªæ¨¡å—ã€‚æŠŠå’Œå†…æ ¸äº¤äº’çš„å·¥å…·ç§°ä¹‹ä¸ºç”¨æˆ·è‚½å·¥å…·ï¼šæ¯”å¦‚ï¼švirshå‘½ä»¤è¡Œã€virt-managerå›¾å½¢ç•Œé¢ï¼Œ</span><br></pre></td></tr></table></figure>

<h2 id="è™šæ‹ŸåŒ–äº§å“åˆ†ç±»"><a href="#è™šæ‹ŸåŒ–äº§å“åˆ†ç±»" class="headerlink" title="è™šæ‹ŸåŒ–äº§å“åˆ†ç±»:"></a>è™šæ‹ŸåŒ–äº§å“åˆ†ç±»:</h2><p><code>æ¡Œé¢çº§è™šæ‹ŸåŒ–</code><br><code>ä¼ä¸šçº§è™šæ‹ŸæœºåŒ–</code></p>
<h2 id="è™šæ‹ŸåŒ–äº§å“åˆ†ç±»ï¼š"><a href="#è™šæ‹ŸåŒ–äº§å“åˆ†ç±»ï¼š" class="headerlink" title="è™šæ‹ŸåŒ–äº§å“åˆ†ç±»ï¼š"></a>è™šæ‹ŸåŒ–äº§å“åˆ†ç±»ï¼š</h2><figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">1.Kvmï¼ˆredhat-----ä¼ä¸šçº§ï¼‰</span><br><span class="line">2.Vmware:</span><br><span class="line">Vmware-workstation(windowså’Œlinux)----æ¡Œé¢çº§</span><br><span class="line">Vmware-fusion(mac)</span><br><span class="line">Vmware-esxi-----(ä¼ä¸šçº§åˆ«)æœ¬èº«å°±æ˜¯ä¸€ä¸ªæ“ä½œç³»ç»Ÿã€‚</span><br><span class="line">3.hyper-v(å¾®è½¯ï¼‰</span><br><span class="line">4.Ovmï¼ˆoracleå…¬å¸--Windows linuxï¼‰ virtulbox</span><br><span class="line">5.Xenï¼ˆrhel6ä¹‹å‰æ‰€æœ‰ç‰ˆæœ¬é»˜è®¤ç”¨çš„è™šæ‹ŸåŒ–äº§å“ï¼‰</span><br></pre></td></tr></table></figure>

<h2 id="éƒ¨ç½²"><a href="#éƒ¨ç½²" class="headerlink" title="éƒ¨ç½²"></a>éƒ¨ç½²</h2><p><strong>ç¬¬ä¸€æ­¥å…ˆåœ¨VMwareä¸Šåˆ›å»ºä¸€ä¸ªè™šæ‹Ÿæœºï¼ˆå†…å­˜èƒ½å¤šå¤§å°±åšå¤šå¤§ï¼‰</strong></p>
<p><code>è™šæ‹Ÿæœºå®‰è£…å¥½ï¼Œæ‰“å¼€è®¾ç½®--å¤„ç†å™¨--è™šæ‹ŸåŒ–å¼•æ“--å‹¾é€‰ç¬¬ä¸€ä¸ª</code></p>
<p><img src="/upload/kvm1.webp" alt="kvm1.webp"></p>
<p><strong>æ‰“å¼€è™šæ‹Ÿæœºï¼ŒæŸ¥çœ‹cpuæ˜¯å¦æ”¯æŒè™šæ‹ŸåŒ–</strong></p>
<figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="section">[root@kvm-server ~]</span><span class="comment"># cat /proc/cpuinfo | grep -E &#x27;vmx|svm&#x27;</span></span><br><span class="line">cmx|svmæ”¯æŒå…¶ä¸­ä¸€ä¸ªå°±å¯ä»¥</span><br></pre></td></tr></table></figure>

<h2 id="æ„å»ºç¯å¢ƒ"><a href="#æ„å»ºç¯å¢ƒ" class="headerlink" title="æ„å»ºç¯å¢ƒ"></a>æ„å»ºç¯å¢ƒ</h2><p><code>å…³é—­é˜²ç«å¢™å’Œselinux</code></p>
<figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">æ¸…ç†ç¯å¢ƒï¼Œå¸è½½æœºå™¨è‡ªå¸¦çš„kvm</span><br><span class="line"><span class="section">[root@kvm-server ~]</span><span class="comment"># yum -y remove `rpm -qa | egrep &#x27;qemu|virt|kvm&#x27;`</span></span><br><span class="line"><span class="comment">#åˆ é™¤å‚¨å­˜è™šæ‹Ÿæœºçš„ä»‹è´¨ã€è™šæ‹Ÿæœºé…ç½®æ–‡ä»¶</span></span><br><span class="line"><span class="section">[root@kvm-server ~]</span><span class="comment"># rm -rf /var/lib/libvirt  /etc/libvirt/</span></span><br><span class="line"><span class="comment">#å‡çº§æ‰€æœ‰åŒ…åŒæ—¶ä¹Ÿå‡çº§è½¯ä»¶å’Œç³»ç»Ÿå†…æ ¸</span></span><br><span class="line"><span class="section">[root@kvm-server ~]</span><span class="comment"># yum upgrade -y</span></span><br><span class="line"><span class="comment">#å®‰è£…è½¯ä»¶</span></span><br><span class="line"><span class="section">[root@kvm-server ~]</span><span class="comment"># yum install *qemu*  *virt*  librbd1-devel -y</span></span><br><span class="line">å…¶å®ä¸‹è½½çš„æ˜¯ä¸‹é¢å‡ æ¬¾è½¯ä»¶</span><br><span class="line"><span class="comment"># qemu-kvm libvirt virt-manager  librbd1-devel</span></span><br><span class="line">qemu-kvm ï¼š ä¸»åŒ…</span><br><span class="line">libvirtï¼šapiæ¥å£</span><br><span class="line">virt-managerï¼šå›¾å½¢åŒ–ç•Œé¢</span><br><span class="line"></span><br><span class="line"><span class="comment">#åœ¨æ‰€è°“çš„kvmæŠ€æœ¯ä¸­ï¼Œåº”ç”¨åˆ°çš„å…¶å®æœ‰2ä¸ªä¸œè¥¿ï¼šqemu+kvm</span></span><br><span class="line">kvmè´Ÿè´£cpuè™šæ‹ŸåŒ–+å†…å­˜è™šæ‹ŸåŒ–ï¼Œå®ç°äº†cpuå’Œå†…å­˜çš„è™šæ‹ŸåŒ–ï¼Œä½†kvmä¸èƒ½æ¨¡æ‹Ÿå…¶ä»–è®¾å¤‡ï¼›</span><br><span class="line">qemuæ˜¯æ¨¡æ‹ŸIOè®¾å¤‡ï¼ˆç½‘å¡ï¼Œç£ç›˜ï¼‰ï¼ŒkvmåŠ ä¸Šqemuä¹‹åå°±èƒ½å®ç°çœŸæ­£æ„ä¹‰ä¸ŠæœåŠ¡å™¨è™šæ‹ŸåŒ–ã€‚</span><br><span class="line">å› ä¸ºç”¨åˆ°äº†ä¸Šé¢ä¸¤ä¸ªä¸œè¥¿ï¼Œæ‰€ä»¥ä¸€èˆ¬éƒ½ç§°ä¹‹ä¸ºqemu-kvmã€‚</span><br><span class="line">libvirtåˆ™æ˜¯è°ƒç”¨kvmè™šæ‹ŸåŒ–æŠ€æœ¯çš„æ¥å£ç”¨äºç®¡ç†çš„ï¼Œç”¨libvirtç®¡ç†æ–¹ä¾¿ï¼Œç›´æ¥ç”¨qemu-kvmçš„æ¥å£å¤ªç¹çã€‚</span><br><span class="line"></span><br><span class="line"><span class="comment">#å¯åŠ¨æœåŠ¡</span></span><br><span class="line"><span class="section">[root@kvm-server ~]</span><span class="comment"># systemctl start libvirtd</span></span><br><span class="line"><span class="comment">#æŸ¥çœ‹kvmæ¨¡å—åŠ è½½</span></span><br><span class="line"><span class="section">[root@kvm-server ~]</span><span class="comment"># lsmod | grep kvm</span></span><br><span class="line">kvm_intel             188644  0 </span><br><span class="line">kvm                   621480  1 kvm_intel</span><br><span class="line">irqbypass              13503  1 kvm</span><br><span class="line">å¦‚æœçœ‹åˆ°æœ‰è¿™ä¸¤è¡Œï¼Œè¯´æ˜æ”¯æŒkvmæ¨¡å—</span><br></pre></td></tr></table></figure>

<p><strong>ä¸‹é¢å°±å¯ä»¥åœ¨VMwareé‡Œé¢å†å®‰è£…è™šæ‹Ÿæœºäº†</strong></p>
<h2 id="å›¾å½¢æ·»åŠ è™šæ‹Ÿæœº"><a href="#å›¾å½¢æ·»åŠ è™šæ‹Ÿæœº" class="headerlink" title="å›¾å½¢æ·»åŠ è™šæ‹Ÿæœº"></a>å›¾å½¢æ·»åŠ è™šæ‹Ÿæœº</h2><figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">åœ¨ç»ˆç«¯è¾“å…¥virt-manager--ç‚¹å‡»ç”µè„‘å›¾æ ‡åˆ›å»º--æœ¬åœ°å®‰è£…ä»‹è´¨--é€‰æ‹©ä½¿ç”¨ISOæ˜ åƒï¼Œå¦å¤–</span><br></pre></td></tr></table></figure>

<p><img src="https://xbd666.cn/upload/kvm2.webp" alt="kvm2.png"></p>
<p><img src="https://xbd666.cn/upload/kvm3.webp" alt="kvm3.png"></p>
<p><img src="https://xbd666.cn/upload/kvm4.webp" alt="kvm4.png"></p>
<p><img src="https://xbd666.cn/upload/kvm5.webp" alt="kvm5.png"></p>
<p><img src="https://xbd666.cn/upload/kvm6.webp" alt="kvm6.png"></p>
<p><img src="https://xbd666.cn/upload/kvm7.webp" alt="kvm7.png"></p>
<h2 id="æ–‡æœ¬æ·»åŠ è™šæ‹Ÿæœº"><a href="#æ–‡æœ¬æ·»åŠ è™šæ‹Ÿæœº" class="headerlink" title="æ–‡æœ¬æ·»åŠ è™šæ‹Ÿæœº"></a>æ–‡æœ¬æ·»åŠ è™šæ‹Ÿæœº</h2><figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#å®‰è£…ftpï¼Œå¹¶é…ç½®æœ€åå°†é•œåƒä¸Šä¼ åˆ°ftpä¸­</span></span><br><span class="line"><span class="section">[root@kvm-server ~]</span><span class="comment"># yum install -y vsftpd</span></span><br><span class="line"><span class="section">[root@kvm-server ~]</span><span class="comment"># mkdir /var/ftp/centos7u4</span></span><br><span class="line"><span class="section">[root@kvm-server ~]</span><span class="comment"># mount /root/CentOS-7-x86_64-DVD-1708.iso /var/ftp/centos7u4/</span></span><br><span class="line"><span class="section">[root@kvm-server ~]</span><span class="comment"># virt-install --connect qemu:///system -n vm10 -r 2050 --disk path=/var/lib/libvirt/images/vm10.img,size=5  --os-type=linux --os-variant=centos7.0 --vcpus=1  --location=ftp://10.0.111.182/centos7u4 -x console=ttyS0 --nographics</span></span><br><span class="line"></span><br><span class="line">æ³¨æ„:</span><br><span class="line">virt-install </span><br><span class="line">bash: virt-install: æœªæ‰¾åˆ°å‘½ä»¤...</span><br><span class="line"><span class="comment"># yum install libguestfs-tools -y</span></span><br><span class="line"><span class="comment"># yum install virt-install.noarch -y</span></span><br><span class="line"></span><br><span class="line">å¦‚æœè¿˜æ˜¯æœ‰é—®é¢˜æ²¡åŠæ³•å®‰è£…ï¼Œéœ€è¦vsftpåŒ¿åæˆæƒï¼Œæ·»åŠ ä»¥ä¸‹å†…å®¹</span><br><span class="line">vim /etc/vsftpd/vsftpd.conf		//é…ç½®æ–‡ä»¶</span><br><span class="line"><span class="attr">anonymous_enable</span>=<span class="literal">YES</span> 		 	//å¼€å¯åŒ¿åç™»å½•</span><br><span class="line"><span class="attr">anon_upload_enable</span>=<span class="literal">YES</span> 			//åŒ¿åè¯»</span><br><span class="line"><span class="attr">anon_mkdir_write_enable</span>=<span class="literal">YES</span> 	//åŒ¿åå†™</span><br><span class="line"></span><br><span class="line"><span class="comment"># é‡å¯ä¸‹vsftp</span></span><br><span class="line"><span class="section">[root@kvm-server ~]</span><span class="comment"># systemctl restart vsftpd</span></span><br><span class="line"></span><br><span class="line">å‚æ•°è§£é‡Šï¼š</span><br><span class="line">-n name</span><br><span class="line">-r  ä»¥Mä¸ºå•ä½æŒ‡å®šåˆ†é…ç»™è™šæ‹Ÿæœºçš„å†…å­˜å¤§å°</span><br><span class="line">--disk æŒ‡å®šä½œä¸ºå®¢æˆ·æœºå­˜å‚¨çš„åª’ä»‹ sizeä»¥Gä¸ºå•ä½çš„å­˜å‚¨</span><br><span class="line">--os-type   ç³»ç»Ÿç±»å‹</span><br><span class="line">--os-variant ç³»ç»Ÿç±»å‹ç‰ˆæœ¬</span><br><span class="line">--vcpus æŒ‡å®šæ ¸æ•°ï¼Œä¸èƒ½è¶…è¿‡ç‰©ç†cpu</span><br><span class="line">--location  å®¢æˆ·è™šæ‹Ÿæœºå®‰è£…æºä¸‹è½½ï¼Œå¿…é¡»ä¸ºé•œåƒæŒ‚è½½åœ¨ftpç›®å½•ä¸‹</span><br><span class="line">-x <span class="attr">console</span>=ttyS0 æ‰§è¡Œç»ˆç«¯<span class="number">0</span></span><br><span class="line">--nographics æ— å›¾å½¢ï¼Œæ–‡æœ¬æ¨¡å¼</span><br><span class="line"></span><br><span class="line"><span class="comment">#ä»¥ä¸‹å°±æ˜¯è¿›å…¥å‘½ä»¤å®‰è£…</span></span><br><span class="line">1ã€é€‰2ï¼Œè¿›å…¥use text mode</span><br><span class="line">2ã€å°†æ‰€æœ‰çš„ï¼è¿›è¡Œç¼–è¾‘ï¼Œç¼–è¾‘å¥½çš„çŠ¶æ€æ˜¯Ã—</span><br><span class="line">3ã€æ›´æ”¹æ—¶é—´é€‰2 -- 1 set timezone-- 2 Asia -- 65 Shanghai</span><br><span class="line">4ã€è®¾ç½®ç£ç›˜5 -- c to continue -- 2 Use All Space -- c to continue -- 3 LVM -- c to continue </span><br><span class="line">5ã€è®¾ç½®å¯†ç 8 -- è‡ªå·±è®¾å®šä¸€ä¸ªå¯†ç  -- yes</span><br><span class="line">6ã€è®¾ç½®å®Œæˆ-- b</span><br><span class="line">7ã€å¼€å§‹åˆ›å»ºï¼Œå¤§æ¦‚20åˆ†é’Ÿå·¦å³</span><br><span class="line">8ã€å‡ºç°installation complete. press return to quit--æŒ‰å›è½¦é€€å‡º--ä¸‹é¢çš„æ“ä½œæ ¹æ®æç¤ºç‚¹ç‚¹å°±å¯ä»¥äº†</span><br></pre></td></tr></table></figure>

<h2 id="æ¨¡æ¿é•œåƒ-é…ç½®æ–‡ä»¶-æ–¹å¼å®‰è£…è™šæ‹Ÿæœºâ€”é‡ç‚¹"><a href="#æ¨¡æ¿é•œåƒ-é…ç½®æ–‡ä»¶-æ–¹å¼å®‰è£…è™šæ‹Ÿæœºâ€”é‡ç‚¹" class="headerlink" title="æ¨¡æ¿é•œåƒ+é…ç½®æ–‡ä»¶ æ–¹å¼å®‰è£…è™šæ‹Ÿæœºâ€”é‡ç‚¹"></a>æ¨¡æ¿é•œåƒ+é…ç½®æ–‡ä»¶ æ–¹å¼å®‰è£…è™šæ‹Ÿæœºâ€”é‡ç‚¹</h2><figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line">1.è™šæ‹Ÿæœºé…ç½®æ–‡ä»¶</span><br><span class="line"><span class="section">[root@kvm-server ~]</span><span class="comment"># ls /etc/libvirt/qemu</span></span><br><span class="line">networks  vm2.xml</span><br><span class="line">2.å‚¨å­˜è™šæ‹Ÿæœºçš„ä»‹è´¨</span><br><span class="line"><span class="section">[root@kvm-server ~]</span><span class="comment"># ls /var/lib/libvirt/images/</span></span><br><span class="line"><span class="attr">vm2.img</span></span><br><span class="line">==============================</span><br><span class="line">defineæ–¹å¼åˆ›å»ºå¥½ï¼Œä¸ä¼šå¯åŠ¨</span><br><span class="line">createæ–¹å¼åˆ›å»ºå¥½ï¼Œä¼šå¯åŠ¨</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ‹·è´æ¨¡æ¿é•œåƒå’Œé…ç½®æ–‡ä»¶</span></span><br><span class="line"><span class="section">[root@kvm-server ~]</span><span class="comment"># cp /etc/libvirt/qemu/vm2.xml /etc/libvirt/qemu/vm3.xml(è‡ªå®šä¹‰åå­—)</span></span><br><span class="line"><span class="section">[root@kvm-server ~]</span><span class="comment"># cp /var/lib/libvirt/images/vm2.img /var/lib/libvirt/images/vm3.img (è‡ªå®šä¹‰åå­—)</span></span><br><span class="line"><span class="comment"># ä¿®æ”¹é…ç½®æ–‡ä»¶</span></span><br><span class="line"><span class="section">[root@kvm-server ~]</span><span class="comment"># vim /etc/libvirt/qemu/vm3.xml</span></span><br><span class="line">domain <span class="attr">type</span>=<span class="string">&#x27;kvm&#x27;</span>&gt;</span><br><span class="line">  &lt;name&gt;vm3&lt;/name&gt;  <span class="comment">#åå­—ä¸èƒ½ä¸€æ ·éœ€è¦ä¿®æ”¹</span></span><br><span class="line">  &lt;uuid&gt;2e3fa6db-ff7f-41c3-bc8f-0428e81ebb57&lt;/uuid&gt; <span class="comment">#uuidä¸èƒ½ä¸€æ ·éœ€è¦ä¿®æ”¹</span></span><br><span class="line">  &lt;memory <span class="attr">unit</span>=<span class="string">&#x27;KiB&#x27;</span>&gt;<span class="number">1024000</span>&lt;/memory&gt;  <span class="comment">#å†…å­˜ï¼Œå¯é€‰</span></span><br><span class="line">  &lt;currentMemory <span class="attr">unit</span>=<span class="string">&#x27;KiB&#x27;</span>&gt;<span class="number">1024000</span>&lt;/currentMemory&gt;  <span class="comment">#å½“å‰å†…å­˜ä¸ä¸Šé¢å®šä¹‰ä¸€æ ·</span></span><br><span class="line">  &lt;vcpu <span class="attr">placement</span>=<span class="string">&#x27;static&#x27;</span>&gt;<span class="number">2</span>&lt;/vcpu&gt;  <span class="comment">#cpuå¯é€‰</span></span><br><span class="line">  &lt;os&gt;</span><br><span class="line">  ã€‚ã€‚ã€‚</span><br><span class="line">  ã€‚ã€‚ã€‚</span><br><span class="line">  ã€‚ã€‚ã€‚</span><br><span class="line">    &lt;devices&gt;</span><br><span class="line">    &lt;emulator&gt;/usr/libexec/qemu-kvm&lt;/emulator&gt;</span><br><span class="line">    &lt;disk <span class="attr">type</span>=<span class="string">&#x27;file&#x27;</span> device=<span class="string">&#x27;disk&#x27;</span>&gt;</span><br><span class="line">      &lt;driver <span class="attr">name</span>=<span class="string">&#x27;qemu&#x27;</span> type=<span class="string">&#x27;qcow2&#x27;</span>/&gt;</span><br><span class="line">      &lt;source <span class="attr">file</span>=<span class="string">&#x27;/var/lib/libvirt/images/vm3.img&#x27;</span>/&gt;   <span class="comment">#ç£ç›˜é•œåƒéœ€è¦ä¿®æ”¹</span></span><br><span class="line">      &lt;target <span class="attr">dev</span>=<span class="string">&#x27;vda&#x27;</span> bus=<span class="string">&#x27;virtio&#x27;</span>/&gt;</span><br><span class="line">      &lt;address <span class="attr">type</span>=<span class="string">&#x27;pci&#x27;</span> domain=<span class="string">&#x27;0x0000&#x27;</span> bus=<span class="string">&#x27;0x00&#x27;</span> slot=<span class="string">&#x27;0x07&#x27;</span> function=<span class="string">&#x27;0x0&#x27;</span>/&gt;</span><br><span class="line">    &lt;/disk&gt;</span><br><span class="line"> ã€‚ã€‚ã€‚</span><br><span class="line"> ã€‚ã€‚ã€‚</span><br><span class="line"> ã€‚ã€‚ã€‚</span><br><span class="line">     &lt;/controller&gt;</span><br><span class="line">    &lt;interface <span class="attr">type</span>=<span class="string">&#x27;network&#x27;</span>&gt;</span><br><span class="line">      &lt;mac <span class="attr">address</span>=<span class="string">&#x27;52:54:00:82:d6:3c&#x27;</span>/&gt;  <span class="comment">#macåœ°å€ä¸èƒ½ä¸€æ ·éœ€è¦ä¿®æ”¹ï¼Œåªèƒ½ä¿®æ”¹åä¸‰æ®µã€‚</span></span><br><span class="line">      &lt;source <span class="attr">network</span>=<span class="string">&#x27;default&#x27;</span>/&gt;</span><br><span class="line">      &lt;model <span class="attr">type</span>=<span class="string">&#x27;virtio&#x27;</span>/&gt;</span><br><span class="line"></span><br><span class="line"><span class="comment">#å¿…é¡»ä¿®æ”¹nameï¼Œuuid,macåœ°å€,ç£ç›˜æ–‡ä»¶åå­—,å…¶ä½™å¯é€‰</span></span><br><span class="line"></span><br><span class="line">ç”¨vimä¿®æ”¹å®Œä¹‹åéœ€è¦defineä¸€ä¸‹é…ç½®æ–‡ä»¶</span><br><span class="line"><span class="section">[root@kvm-server ~]</span><span class="comment"># virsh define /etc/libvirt/qemu/vm3.xml</span></span><br><span class="line">é‡å¯ä¸€ä¸‹ï¼š</span><br><span class="line"><span class="section">[root@kvm-server ~]</span><span class="comment"># systemctl restart libvirtd</span></span><br><span class="line">å®¿ä¸»æœºå¼€å¯è·¯ç”±è½¬å‘ï¼š</span><br><span class="line"><span class="section">[root@kvm-server ~]</span><span class="comment"># vim /etc/sysctl.conf </span></span><br><span class="line"><span class="section">[root@kvm-server ~]</span><span class="comment"># sysctl -p</span></span><br><span class="line"><span class="attr">net.ipv4.ip_forward</span> = <span class="number">1</span></span><br><span class="line">æŸ¥çœ‹è™šæ‹Ÿæœºåˆ—è¡¨ï¼š</span><br><span class="line"><span class="section">[root@kvm-server ~]</span><span class="comment"># virsh list --all</span></span><br><span class="line"> Id    åç§°                         çŠ¶æ€</span><br><span class="line">----------------------------------------------------</span><br><span class="line"> -     vm2                            å…³é—­</span><br><span class="line"> -     vm3                            å…³é—­</span><br></pre></td></tr></table></figure>

<h2 id="KVMè™šæ‹Ÿæœºç®¡ç†"><a href="#KVMè™šæ‹Ÿæœºç®¡ç†" class="headerlink" title="KVMè™šæ‹Ÿæœºç®¡ç†"></a>KVMè™šæ‹Ÿæœºç®¡ç†</h2><figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"><span class="section">[root@kvm-server ~]</span><span class="comment"># virsh list  #åˆ—å‡ºåœ¨è¿è¡ŒçŠ¶æ€ä¸­çš„è™šæ‹Ÿæœº</span></span><br><span class="line"><span class="section">[root@kvm-server ~]</span><span class="comment"># virsh list --all  #åˆ—å‡ºæ‰€æœ‰è™šæ‹Ÿæœº</span></span><br><span class="line">æŸ¥çœ‹kvmè™šæ‹Ÿæœºé…ç½®æ–‡ä»¶ï¼š</span><br><span class="line"><span class="comment">#è¯­æ³•ï¼švirsh dumpxml vm_name</span></span><br><span class="line"><span class="section">[root@kvm-server ~]</span><span class="comment"># virsh dumpxml vm3</span></span><br><span class="line"></span><br><span class="line">å¯åŠ¨</span><br><span class="line"><span class="section">[root@kvm-server ~]</span><span class="comment"># virsh start vm2</span></span><br><span class="line">åŸŸ vm2 å·²å¼€å§‹</span><br><span class="line"></span><br><span class="line">æš‚åœè™šæ‹Ÿæœºï¼š</span><br><span class="line"><span class="section">[root@kvm-server ~]</span><span class="comment"># virsh suspend vm_name</span></span><br><span class="line">åŸŸ vm2 è¢«æŒ‚èµ·</span><br><span class="line"></span><br><span class="line">æ¢å¤è™šæ‹Ÿæœºï¼š</span><br><span class="line"><span class="section">[root@kvm-server ~]</span><span class="comment"># virsh resume vm_name</span></span><br><span class="line">åŸŸ vm2 è¢«é‡æ–°æ¢å¤</span><br><span class="line"></span><br><span class="line">å…³é—­ï¼š</span><br><span class="line">æ–¹æ³•1ï¼š</span><br><span class="line"><span class="section">[root@kvm-server ~]</span><span class="comment"># virsh shutdown vm3</span></span><br><span class="line">åŸŸ vm3 è¢«å…³é—­</span><br><span class="line"></span><br><span class="line">é‡å¯ï¼š</span><br><span class="line"><span class="section">[root@kvm-server ~]</span><span class="comment"># virsh reboot vm3</span></span><br><span class="line">åŸŸ vm3 æ­£åœ¨è¢«é‡æ–°å¯åŠ¨</span><br><span class="line"></span><br><span class="line">é‡ç½®:</span><br><span class="line"><span class="section">[root@kvm-server ~]</span><span class="comment"># virsh reset vm3</span></span><br><span class="line">vm3   <span class="comment">#æ–­ç”µé‡å¯ã€‚é€Ÿåº¦å¿«</span></span><br><span class="line">Domain vm3 was reset</span><br><span class="line"></span><br><span class="line">åˆ é™¤è™šæ‹Ÿæœº:</span><br><span class="line"><span class="section">[root@kvm-server ~]</span><span class="comment"># virsh undefine vm2</span></span><br><span class="line">Domain vm2 has been undefined</span><br><span class="line">æ³¨æ„:è™šæ‹Ÿæœºåœ¨å¼€å¯çš„æƒ…å†µä¸‹undefineæ˜¯æ— æ³•åˆ é™¤çš„åªæ˜¯å°†é…ç½®æ–‡ä»¶åˆ é™¤äº†ï¼Œä¸èƒ½åˆ é™¤ç£ç›˜æ–‡ä»¶ã€‚éœ€è¦æ‰‹åŠ¨rmï¼Œæœ€å¥½è¿˜æ˜¯åœ¨virt-manageré‡Œé¢å³å‡»åˆ é™¤</span><br><span class="line"></span><br><span class="line">è™šæ‹Ÿæœºå¼€æœºè‡ªåŠ¨å¯åŠ¨:</span><br><span class="line"><span class="comment">#å¦‚æœè™šæ‹Ÿæœºå¼€æœºè‡ªå¯ï¼Œé‡Œé¢çš„æœåŠ¡åº”è¯¥è®¾ç½®çš„æœ‰å¼€æœºè‡ªå¯ï¼Œä¸ç„¶æ²¡æœ‰æ„ä¹‰</span></span><br><span class="line"><span class="section">[root@kvm-server ~]</span><span class="comment"># virsh autostart vm_name</span></span><br><span class="line">åŸŸ vm3æ ‡è®°ä¸ºè‡ªåŠ¨å¼€å§‹</span><br><span class="line"></span><br><span class="line"><span class="section">[root@kvm-server ~]</span><span class="comment"># ls /etc/libvirt/qemu/autostart/     //æ­¤ç›®å½•é»˜è®¤ä¸å­˜åœ¨ï¼Œåœ¨æœ‰å¼€æœºå¯åŠ¨çš„è™šæ‹Ÿæœºæ—¶è‡ªåŠ¨åˆ›å»º</span></span><br><span class="line">vm3.xml</span><br><span class="line"></span><br><span class="line">å…³é—­å¼€æœºå¯åŠ¨</span><br><span class="line"><span class="section">[root@kvm-server ~]</span><span class="comment"># virsh autostart --disable vm_name</span></span><br><span class="line">åŸŸ vm3å–æ¶ˆæ ‡è®°ä¸ºè‡ªåŠ¨å¼€å§‹</span><br><span class="line"><span class="section">[root@kvm-server ~]</span><span class="comment"># ls /etc/libvirt/qemu/autostart/</span></span><br><span class="line"></span><br><span class="line">å¦‚ä½•æŸ¥çœ‹å·²å¯åŠ¨çš„è™šæ‹Ÿæœºipåœ°å€</span><br><span class="line">å‡å¦‚vm3è™šæ‹Ÿæœºå·²å¯åŠ¨</span><br><span class="line"><span class="section">[root@kvm-server ~]</span><span class="comment"># virsh domifaddr vm3</span></span><br><span class="line"> åç§°     MAC åœ°å€           Protocol     Address</span><br><span class="line">-------------------------------------------------------------------------------</span><br><span class="line"> vnet0      52:54:00:82:d6:3c    ipv4         192.168.122.85/24</span><br></pre></td></tr></table></figure>

<h2 id="è™šæ‹Ÿæœºæ·»åŠ è®¾å¤‡"><a href="#è™šæ‹Ÿæœºæ·»åŠ è®¾å¤‡" class="headerlink" title="è™šæ‹Ÿæœºæ·»åŠ è®¾å¤‡"></a>è™šæ‹Ÿæœºæ·»åŠ è®¾å¤‡</h2><p>1ã€å›¾åƒæ–¹å¼æ·»åŠ </p>
<figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">è¾“å…¥virt-manager--å³å‡»ç‚¹å‡»ä½ æƒ³è¦æ·»åŠ è®¾å¤‡çš„è™šæ‹Ÿæœº--æŸ¥çœ‹--è¯¦æƒ…--å·¦ä¸‹è§’--æ·»åŠ ç¡¬ä»¶--å®‰è£…éœ€æ±‚æ·»åŠ å°±å¯ä»¥äº†</span><br></pre></td></tr></table></figure>

<p>2ã€ä¿®æ”¹é…ç½®æ–‡ä»¶æ–¹å¼æ·»åŠ </p>
<figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="section">[root@kvm-server ~]</span><span class="comment"># qemu-img create -f qcow2 /var/lib/libvirt/images/vm4-1.qcow2 5G</span></span><br><span class="line"><span class="section">[root@kvm-server ~]</span><span class="comment"># cd /etc/libvirt/qemu/</span></span><br><span class="line"><span class="section">[root@kvm-server qemu]</span><span class="comment"># vim vm3.xml</span></span><br></pre></td></tr></table></figure>

<p><img src="https://xbd666.cn/upload/kvm8.webp" alt="kvm8.png"></p>
<figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">åŠ å¥½ä¹‹åï¼Œå¯åŠ¨è™šæ‹Ÿæœº</span><br><span class="line"><span class="section">[root@kvm-server qemu]</span><span class="comment"># systemctl restart libvirtd</span></span><br><span class="line"><span class="section">[root@kvm-server qemu]</span><span class="comment"># virsh list --all</span></span><br><span class="line"> Id    åç§°                         çŠ¶æ€</span><br><span class="line">----------------------------------------------------</span><br><span class="line"> 6     centos7.0                      running</span><br><span class="line"> -     vm3                            å…³é—­</span><br><span class="line"><span class="section">[root@kvm-server qemu]</span><span class="comment"># virsh start vm3</span></span><br><span class="line"></span><br><span class="line">å¯ä»¥çœ‹åˆ°æˆ‘ä»¬æ–°æ·»åŠ çš„ç£ç›˜vdb</span><br><span class="line"><span class="comment">#ç„¶åå¯ä»¥æ­£å¸¸åˆ†åŒºï¼Œåˆ¶ä½œæ–‡ä»¶ç³»ç»Ÿï¼Œè¿›è¡ŒæŒ‚è½½</span></span><br></pre></td></tr></table></figure>


<p><img src="https://xbd666.cn/upload/kvm9.webp" alt="kvm9.png"></p>
<h2 id="è™šæ‹Ÿæœºå…‹éš†"><a href="#è™šæ‹Ÿæœºå…‹éš†" class="headerlink" title="è™šæ‹Ÿæœºå…‹éš†"></a>è™šæ‹Ÿæœºå…‹éš†</h2><p>1.å›¾å½¢ç•Œé¢ï¼šApplications ï¼ˆå·¦ä¸Šè§’ï¼‰â€”â€“&gt; System Tools â€”â€”&gt;Virtual Machine Manager<br>   <code>å…³é—­è¦å…‹éš†çš„è™šæ‹Ÿæœºï¼Œå³é”®ç‚¹å‡»è™šæ‹Ÿæœºé€‰æ‹©Clone</code></p>
<p><img src="https://xbd666.cn/upload/kvm10.webp" alt="kvm10.png"></p>
<p>2.åœ¨ç»ˆç«¯æ‰§è¡Œå‘½ä»¤å…‹éš†</p>
<figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="section">[root@kvm-server ~]</span><span class="comment"># virt-clone -o vm2 -n vm5 --auto-clone</span></span><br><span class="line">æ­£åœ¨åˆ†é… &#x27;vm5.qcow2&#x27;                                    | 5.0 GB  00:00     </span><br><span class="line">æˆåŠŸå…‹éš† &#x27;vm5&#x27;ã€‚</span><br><span class="line">-o      origin-åŸå§‹</span><br><span class="line">-n :æŒ‡å®šæ–°å®¢æˆ·æœºçš„åå­—</span><br><span class="line"></span><br><span class="line"><span class="section">[root@kvm-server ~]</span><span class="comment"># virsh list --all</span></span><br><span class="line"> Id    åç§°                         çŠ¶æ€</span><br><span class="line">----------------------------------------------------</span><br><span class="line"> -     vm2                            å…³é—­</span><br><span class="line"> -     vm5		                      å…³é—­</span><br></pre></td></tr></table></figure>
<h2 id="kvmé«˜çº§å‘½ä»¤"><a href="#kvmé«˜çº§å‘½ä»¤" class="headerlink" title="kvmé«˜çº§å‘½ä»¤"></a>kvmé«˜çº§å‘½ä»¤</h2><p>ç£ç›˜é•œåƒæ–‡ä»¶çš„æ ¼å¼ï¼š<code>raw  qcow2</code></p>
<ul>
<li>rawï¼šç«‹åˆ»åˆ†é…ç©ºé—´ï¼Œä¸ç®¡ä½ æœ‰æ²¡æœ‰ç”¨åˆ°é‚£ä¹ˆå¤šç©ºé—´</li>
<li>qcow2ï¼šåªæ˜¯æ‰¿è¯ºç»™ä½ åˆ†é…ç©ºé—´ï¼Œä½†æ˜¯åªæœ‰å½“ä½ éœ€è¦ç”¨ç©ºé—´çš„æ—¶å€™ï¼Œæ‰ä¼šç»™ä½ ç©ºé—´ã€‚æœ€å¤šåªç»™ä½ æ‰¿è¯ºç©ºé—´çš„å¤§å°ï¼Œé¿å…ç©ºé—´æµªè´¹</li>
</ul>
<h2 id="å»ºç«‹qcow2æ ¼å¼ç£ç›˜æ–‡ä»¶"><a href="#å»ºç«‹qcow2æ ¼å¼ç£ç›˜æ–‡ä»¶" class="headerlink" title="å»ºç«‹qcow2æ ¼å¼ç£ç›˜æ–‡ä»¶"></a>å»ºç«‹qcow2æ ¼å¼ç£ç›˜æ–‡ä»¶</h2><figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="section">[root@kvm-server images]</span><span class="comment"># pwd</span></span><br><span class="line">/var/lib/libvirt/images</span><br><span class="line"><span class="comment">#åˆ›å»ºqcow2æ ¼å¼ç£ç›˜æ ¼å¼æ–‡ä»¶ï¼ˆvm1.qcow2æ˜¯è‡ªå®šä¹‰çš„ç£ç›˜åå­—ï¼‰</span></span><br><span class="line"><span class="section">[root@kvm-server images]</span><span class="comment"># qemu-img create -f qcow2 vm1.qcow2 5G</span></span><br><span class="line">Formatting &#x27;vm1.qcow2&#x27;, <span class="attr">fmt</span>=qcow2 size=<span class="number">5368709120</span> encryption=<span class="literal">off</span> cluster_size=<span class="number">65536</span> lazy_refcounts=<span class="literal">off</span> </span><br><span class="line"></span><br><span class="line"><span class="comment">#åˆ›å»ºrawæ ¼å¼ç£ç›˜æ ¼å¼æ–‡ä»¶ï¼ˆvm2.rawæ˜¯è‡ªå®šä¹‰çš„ç£ç›˜åå­—ï¼‰</span></span><br><span class="line"><span class="section">[root@kvm-server images]</span><span class="comment"># qemu-img create -f raw vm2.raw 5G</span></span><br><span class="line">Formatting &#x27;vm2.raw&#x27;, <span class="attr">fmt</span>=raw size=<span class="number">5368709120</span> </span><br><span class="line"></span><br><span class="line"><span class="comment">#æŸ¥çœ‹å·²ç»åˆ›å»ºçš„è™šæ‹Ÿç£ç›˜æ–‡ä»¶</span></span><br><span class="line"><span class="section">[root@kvm-server images]</span><span class="comment"># qemu-img info vm1.qcow2</span></span><br><span class="line"><span class="section">[root@kvm-server images]</span><span class="comment"># qemu-img info vm2.raw</span></span><br></pre></td></tr></table></figure>

<h2 id="æŒ‚è½½ç£ç›˜"><a href="#æŒ‚è½½ç£ç›˜" class="headerlink" title="æŒ‚è½½ç£ç›˜"></a>æŒ‚è½½ç£ç›˜</h2><figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># å°†è™šæ‹Ÿæœºå…ˆå…³é—­</span></span><br><span class="line">æŸ¥çœ‹vm2ç£ç›˜é•œåƒåˆ†åŒºä¿¡æ¯--ï¼ˆéœ€è¦ç­‰ä¸€ä¼šä¼šï¼‰</span><br><span class="line"><span class="section">[root@kvm-server images]</span><span class="comment"># virt-df -h -d vm2</span></span><br><span class="line">æ–‡ä»¶ç³»ç»Ÿ                                  å¤§å°      å·²ç”¨ç©ºé—´    å¯ç”¨ç©ºé—´     ä½¿ç”¨ç™¾åˆ†æ¯”%</span><br><span class="line">vm2:/dev/sda1                            1014M        92M       922M         10%</span><br><span class="line">vm2:/dev/centos/root                      3.5G       863M       2.6G         25%</span><br><span class="line"></span><br><span class="line"><span class="comment"># åˆ›å»ºä¸€ä¸ªæŒ‚è½½ç›®å½•</span></span><br><span class="line"><span class="section">[root@kvm-server ~]</span><span class="comment"># mkdir /test</span></span><br><span class="line"><span class="comment">#æŒ‚è½½è™šæ‹Ÿæœºçš„æ ¹åˆ†åŒºåˆ°testç›®å½•</span></span><br><span class="line"><span class="section">[root@kvm-server ~]</span><span class="comment"># guestmount -d vm2 -m /dev/centos/root --rw /test/</span></span><br><span class="line"><span class="section">[root@kvm-server ~]</span><span class="comment"># ll /test</span></span><br><span class="line">bin   dev  home  lib64  mnt  proc  run   srv  tmp  var</span><br><span class="line">boot  etc  lib   media  opt  root  sbin  sys  usr</span><br><span class="line"></span><br><span class="line"><span class="comment"># å–æ¶ˆæŒ‚è½½</span></span><br><span class="line"><span class="section">[root@kvm-server ~]</span><span class="comment"># guestunmount /test</span></span><br></pre></td></tr></table></figure>

<h2 id="KVMå­˜å‚¨é…ç½®"><a href="#KVMå­˜å‚¨é…ç½®" class="headerlink" title="KVMå­˜å‚¨é…ç½®"></a>KVMå­˜å‚¨é…ç½®</h2><figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#kvmé»˜è®¤å­˜å‚¨æ± çš„ä½ç½®ï¼š</span></span><br><span class="line">    /var/lib/libvirt/images/    </span><br></pre></td></tr></table></figure>

<p>1ã€å›¾å½¢æ–¹å¼åˆ›å»ºå­˜å‚¨æ± </p>
<p><img src="https://xbd666.cn/upload/kvm11.webp" alt="kvm2.png"></p>
<p><img src="https://xbd666.cn/upload/kvm12.webp" alt="kvm2.png"></p>
<p><img src="https://xbd666.cn/upload/kvm13.webp" alt="kvm2.png"></p>
<p><img src="https://xbd666.cn/upload/kvm14.webp" alt="kvm2.png"></p>
<p>2ã€å‘½ä»¤æ–¹å¼åˆ›å»ºå­˜å‚¨æ± </p>
<figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line">1.åˆ›å»ºåŸºäºæ–‡ä»¶å¤¹çš„å­˜å‚¨æ± ï¼ˆç›®å½•ï¼Œå¯è‡ªå®šä¹‰ï¼‰</span><br><span class="line"><span class="section">[root@kvm-server ~]</span><span class="comment"># mkdir -p /data/vmfs</span></span><br><span class="line"></span><br><span class="line">2.å®šä¹‰å­˜å‚¨æ± ä¸å…¶ç›®å½•--ï¼ˆvm1æ˜¯å­˜å‚¨æ± åå­—ï¼Œè‡ªå·±è‡ªå®šä¹‰ï¼‰</span><br><span class="line"><span class="section">[root@kvm-server ~]</span><span class="comment"># virsh pool-define-as vm1 --type dir --target /data/vmfs</span></span><br><span class="line">Pool vm1 defined</span><br><span class="line"></span><br><span class="line">3.åˆ›å»ºå·²å®šä¹‰çš„å­˜å‚¨æ± </span><br><span class="line">(1)æ„å»ºå·²å®šä¹‰çš„å­˜å‚¨æ± </span><br><span class="line"><span class="section">[root@kvm-server ~]</span><span class="comment"># virsh pool-build vm1</span></span><br><span class="line">Pool vm1 built</span><br><span class="line"></span><br><span class="line">(2)æŸ¥çœ‹å·²å®šä¹‰çš„å­˜å‚¨æ± ï¼Œå­˜å‚¨æ± ä¸æ¿€æ´»æ— æ³•ä½¿ç”¨ã€‚</span><br><span class="line"><span class="section">[root@kvm-server ~]</span><span class="comment"># virsh pool-list --all</span></span><br><span class="line">Name                 State      Autostart </span><br><span class="line">-------------------------------------------</span><br><span class="line"> default             active       yes       </span><br><span class="line"> ISO                 active       yes       </span><br><span class="line"> vm1              inactive     no     </span><br><span class="line"> </span><br><span class="line">4.æ¿€æ´»å¹¶è‡ªåŠ¨å¯åŠ¨å·²å®šä¹‰çš„å­˜å‚¨æ± </span><br><span class="line"><span class="section">[root@kvm-server ~]</span><span class="comment"># virsh pool-start vm1</span></span><br><span class="line">Pool vm1 started</span><br><span class="line"><span class="section">[root@kvm-server ~]</span><span class="comment"># virsh pool-autostart vm1</span></span><br><span class="line">Pool vm1 marked as autostarted</span><br><span class="line"></span><br><span class="line"><span class="comment">#æ­¤æ—¶æŸ¥çœ‹éƒ½æ˜¯åœ¨è¿è¡Œä¸­ï¼Œå¹¶ä¸”æ˜¯å¼€æœºè‡ªå¯</span></span><br><span class="line"><span class="section">[root@kvm-server ~]</span><span class="comment"># virsh pool-list --all</span></span><br><span class="line"> Name                 State      Autostart </span><br><span class="line">-------------------------------------------</span><br><span class="line"> default              active     yes       </span><br><span class="line"> ISO                 active     yes       </span><br><span class="line"> vm1               active     yes   </span><br><span class="line">è¿™é‡Œvm1å­˜å‚¨æ± å°±å·²ç»åˆ›å»ºå¥½äº†ï¼Œå¯ä»¥ç›´æ¥åœ¨è¿™ä¸ªå­˜å‚¨æ± ä¸­åˆ›å»ºè™šæ‹Ÿç£ç›˜æ–‡ä»¶äº†ã€‚</span><br><span class="line"></span><br><span class="line">5.åœ¨å­˜å‚¨æ± ä¸­åˆ›å»ºè™šæ‹Ÿæœºå­˜å‚¨å·--ï¼ˆvm1-1.qcow2æ˜¯è‡ªå®šä¹‰å­˜å‚¨å·çš„åå­—ï¼Œ2Gæ˜¯è‡ªå®šä¹‰çš„å¤§å°ï¼‰</span><br><span class="line"><span class="section">[root@kvm-server ~]</span><span class="comment"># virsh vol-create-as vm1 vm1-1.qcow2 2G --format qcow2 </span></span><br><span class="line">Vol vm1-1.qcow2 created</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="section">[root@kvm-server ~]</span><span class="comment"># ll /data/vmfs/ -h</span></span><br><span class="line">æ€»ç”¨é‡ 196K</span><br><span class="line">-rw------- 1 root root 193K 10æœˆ 25 16:04 vm1-1.qcow2</span><br><span class="line"></span><br><span class="line">6.å­˜å‚¨æ± ç›¸å…³ç®¡ç†å‘½ä»¤</span><br><span class="line">(1)åœ¨å­˜å‚¨æ± ä¸­åˆ é™¤è™šæ‹Ÿæœºå­˜å‚¨å·</span><br><span class="line"><span class="section">[root@kvm-server ~]</span><span class="comment"># virsh vol-delete --pool vm1 vm1-1.qcow2</span></span><br><span class="line">Vol vm1-1.qcow2 deleted</span><br><span class="line"></span><br><span class="line">(2)å–æ¶ˆæ¿€æ´»å­˜å‚¨æ± </span><br><span class="line"><span class="section">[root@kvm-server ~]</span><span class="comment"># virsh pool-destroy vm1</span></span><br><span class="line">Pool vm1 destroyed</span><br><span class="line"></span><br><span class="line">(3)åˆ é™¤å­˜å‚¨æ± å®šä¹‰çš„ç›®å½•/data/vmfs</span><br><span class="line"><span class="section">[root@kvm-server ~]</span><span class="comment"># virsh pool-delete vm1</span></span><br><span class="line">Pool vm1 deleted</span><br><span class="line"></span><br><span class="line">(4)å–æ¶ˆå®šä¹‰å­˜å‚¨æ± </span><br><span class="line"><span class="section">[root@kvm-server ~]</span><span class="comment"># virsh pool-undefine vm1</span></span><br><span class="line">Pool vm1 has been undefined</span><br><span class="line"></span><br><span class="line">åˆ°æ­¤kvmå­˜å‚¨æ± é…ç½®ä¸ç®¡ç†æ“ä½œå®Œæ¯•ã€‚ </span><br></pre></td></tr></table></figure>

<h2 id="kvmå¿«ç…§"><a href="#kvmå¿«ç…§" class="headerlink" title="kvmå¿«ç…§"></a>kvmå¿«ç…§</h2><p>1ã€å›¾å½¢æ–¹å¼åˆ›å»ºå¿«ç…§</p>
<p><img src="https://xbd666.cn/upload/kvm15.webp" alt="kvm2.png"></p>
<p>2ã€å‘½ä»¤æ–¹å¼åˆ›å»ºå¿«ç…§</p>
<figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">ä¸ºè™šæ‹Ÿæœºvm2åˆ›å»ºä¸€ä¸ªå¿«ç…§ï¼ˆç£ç›˜æ ¼å¼å¿…é¡»ä¸ºqcow2ï¼‰</span><br><span class="line"><span class="section">[root@kvm-server ~]</span><span class="comment"># virsh snapshot-create-as vm2 vm2.snap1</span></span><br><span class="line"></span><br><span class="line">æ³¨æ„ï¼šå¦‚æœåœ¨åˆ›å»ºå¿«ç…§çš„æ—¶å€™æŠ¥é”™ï¼š</span><br><span class="line">error: unsupported configuration: internal snapshot for disk vda unsupported for storage type raw</span><br><span class="line"></span><br><span class="line"><span class="comment">#rawä¸æ”¯æŒsnapshot--å¯ä»¥å°†rawæ ¼å¼è½¬æ¢æˆqcow2æ ¼å¼</span></span><br><span class="line"></span><br><span class="line">æŸ¥çœ‹ç£ç›˜æ–‡ä»¶æ ¼å¼</span><br><span class="line"><span class="section">[root@kvm-server images]</span><span class="comment"># qemu-img info /var/lib/libvirt/images/vm2.qcow2</span></span><br><span class="line">image: /var/lib/libvirt/images/vm2.qcow2</span><br><span class="line">file format: qcow2</span><br><span class="line">virtual size: 5.0G (5368709120 bytes)</span><br><span class="line">disk size: 5.0G</span><br><span class="line">cluster_size: 65536</span><br><span class="line">Format specific information:</span><br><span class="line">    compat: 1.1</span><br><span class="line">    lazy refcounts: true</span><br></pre></td></tr></table></figure>

<figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æŸ¥çœ‹æŸå°è™šæ‹Ÿæœºè®¾å¤‡çš„å¿«ç…§</span></span><br><span class="line"><span class="section">[root@kvm-server ~]</span><span class="comment"># virsh snapshot-list  vm2   </span></span><br><span class="line"> Name                 Creation Time             State</span><br><span class="line">------------------------------------------------------------</span><br><span class="line"></span><br><span class="line"><span class="comment"># åˆ›å»ºä¸€å—ç£ç›˜</span></span><br><span class="line">åˆ›å»º--æ ¼å¼ä¸ºrawï¼Œåå­—ä¸ºvm2-1.rawï¼Œå¤§å°ä¸º2Gçš„ç£ç›˜</span><br><span class="line"><span class="section">[root@kvm-server ~]</span><span class="comment"># qemu-img create -f raw /var/lib/libvirt/images/vm2-1.raw 2G</span></span><br><span class="line">Formatting &#x27;/var/lib/libvirt/images/vm2-1.raw&#x27;, <span class="attr">fmt</span>=raw size=<span class="number">2147483648</span> </span><br><span class="line"><span class="comment"># æŸ¥çœ‹</span></span><br><span class="line"><span class="section">[root@kvm-server ~]</span><span class="comment"># ll -h /var/lib/libvirt/images/vm2-1.raw</span></span><br><span class="line">-rw-r--r-- 1 root root 2.0G 10æœˆ 25 16:25 /var/lib/libvirt/images/vm2-1.raw</span><br><span class="line"></span><br><span class="line"><span class="comment"># å°†å…¶æ·»åŠ åˆ°vm2è™šæ‹Ÿæœºä¸Šé¢</span></span><br><span class="line"><span class="section">[root@kvm-server ~]</span><span class="comment"># cd /etc/libvirt/qemu/</span></span><br><span class="line"><span class="section">[root@kvm-server qemu]</span><span class="comment"># vim vm2.xml </span></span><br></pre></td></tr></table></figure>

<p><img src="https://xbd666.cn/upload/kvm16.webp" alt="kvm2.png"></p>
<figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># å®šä¹‰é…ç½®æ–‡ä»¶</span></span><br><span class="line"><span class="section">[root@kvm-server images]</span><span class="comment"># virsh define /etc/libvirt/qemu/vm2.xml</span></span><br><span class="line"><span class="section">[root@kvm-server images]</span><span class="comment"># virsh start vm2</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># éªŒè¯rawæ ¼å¼æ˜¯ä¸èƒ½æ‹å¿«ç…§çš„</span></span><br><span class="line"><span class="section">[root@kvm-server qemu]</span><span class="comment"># virsh snapshot-create-as vm2 vm2.snap1</span></span><br><span class="line">é”™è¯¯ï¼šä¸æ”¯æŒçš„é…ç½®ï¼šå­˜å‚¨ç±»å‹ vdb ä¸æ”¯æŒç£ç›˜ raw çš„å†…éƒ¨å¿«ç…§</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># ç£ç›˜æ ¼å¼çš„è½¬æ¢</span></span><br><span class="line">ç”±äºrawçš„ç£ç›˜æ ¼å¼ï¼Œä¸æ”¯æŒå¿«ç…§åŠŸèƒ½ï¼Œæˆ‘ä»¬éœ€è¦å°†å…¶è½¬æ¢ä¸ºqcow2çš„æ ¼å¼</span><br><span class="line"><span class="section">[root@kvm-server qemu]</span><span class="comment"># qemu-img convert -O qcow2 /var/lib/libvirt/images/vm2-1.raw  /var/lib/libvirt/images/vm2-1.qcow2</span></span><br><span class="line"></span><br><span class="line"><span class="section">[root@kvm-server qemu]</span><span class="comment"># cd /var/lib/libvirt/images/</span></span><br><span class="line"><span class="section">[root@kvm-server images]</span><span class="comment"># ll -h </span></span><br><span class="line">æ€»ç”¨é‡ 21G</span><br><span class="line">-rw------- 1 root root 5.1G 10æœˆ 24 18:59 centos7.0.qcow2</span><br><span class="line">-rw-r--r-- 1 root root 193K 10æœˆ 25 16:44 vm2-1.qcow2</span><br><span class="line">-rw-r--r-- 1 root root 2.0G 10æœˆ 25 16:25 vm2-1.raw</span><br><span class="line">-rw------- 1 root root 5.1G 10æœˆ 25 16:13 vm2.qcow2</span><br><span class="line"></span><br><span class="line"><span class="comment"># æŸ¥çœ‹</span></span><br><span class="line"><span class="section">[root@kvm-server images]</span><span class="comment"># qemu-img info /var/lib/libvirt/images/vm2-1.qcow2</span></span><br><span class="line">image: /var/lib/libvirt/images/vm2-1.qcow2</span><br><span class="line">file format: qcow2</span><br><span class="line">virtual size: 2.0G (2147483648 bytes)</span><br><span class="line">disk size: 196K</span><br><span class="line">cluster_size: 65536</span><br><span class="line">Format specific information:</span><br><span class="line">    compat: 1.1</span><br><span class="line">    lazy refcounts: false</span><br><span class="line">    </span><br><span class="line"><span class="comment"># ç„¶åå»ä¿®æ”¹vm2è™šæ‹Ÿæœºçš„ç£ç›˜æ ¼å¼å’Œåç§°</span></span><br><span class="line"><span class="section">[root@kvm-server images]</span><span class="comment"># vim /etc/libvirt/qemu/vm2.xml</span></span><br></pre></td></tr></table></figure>

<p><img src="https://xbd666.cn/upload/kvm17.webp" alt="kvm2.png"></p>
<figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="section">[root@kvm-server images]</span><span class="comment"># virsh define /etc/libvirt/qemu/vm2.xml</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># åˆ›å»ºå¿«ç…§</span></span><br><span class="line"><span class="section">[root@kvm-server qemu]</span><span class="comment"># virsh snapshot-create-as vm2 vm2.snap2</span></span><br><span class="line">å·²ç”ŸæˆåŸŸå¿«ç…§ vm2.snap2</span><br><span class="line"><span class="comment"># æ­¤æ—¶rawæ ¼å¼è½¬æ¢æˆqcow2æ ¼å¼ï¼Œå¹¶å¿«ç…§æˆåŠŸ</span></span><br><span class="line"></span><br><span class="line">ä»¥ä¸‹æ“ä½œä¸ºå›æº¯å¿«ç…§</span><br><span class="line"><span class="comment"># å¼€æœºå¹¶å†æ¬¡åˆ›å»ºå¿«ç…§-- é€‰æ‹©ä¸€å°è™šæ‹Ÿæœºè¿›è¡Œå¿«ç…§ï¼Œæ­¤æ—¶å¤„äºå…³é—­çŠ¶æ€</span></span><br><span class="line"><span class="section">[root@kvm-server ~]</span><span class="comment"># virsh snapshot-create-as vm3 vm3-snap1</span></span><br><span class="line">å·²ç”ŸæˆåŸŸå¿«ç…§ vm3-snap1</span><br><span class="line"></span><br><span class="line"><span class="comment">#æ­¤æ—¶å¼€å¯vm3è™šæ‹Ÿæœºï¼Œå¹¶è¿›è¡Œå¿«ç…§</span></span><br><span class="line"><span class="section">[root@kvm-server ~]</span><span class="comment"># virsh start vm3</span></span><br><span class="line"><span class="section">[root@kvm-server ~]</span><span class="comment"># virsh snapshot-create-as vm3 vm3-snap2</span></span><br><span class="line">å·²ç”ŸæˆåŸŸå¿«ç…§ vm3-snap2</span><br><span class="line"></span><br><span class="line">æŸ¥çœ‹å¿«ç…§</span><br><span class="line"><span class="section">[root@kvm-server ~]</span><span class="comment"># virsh snapshot-list vm3 </span></span><br><span class="line"> åç§°               ç”Ÿæˆæ—¶é—´              çŠ¶æ€</span><br><span class="line">------------------------------------------------------------</span><br><span class="line"> vm3-snap1            2019-10-30 15:27:15 +0800 running</span><br><span class="line"> vm3-snap2            2019-10-30 15:29:37 +0800 shutoff</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># æ¢å¤åˆ°å¿«ç…§vm3-snap1ï¼Œç°åœ¨è™šæ‹Ÿæœºå¤„äºå¼€å¯çŠ¶æ€</span></span><br><span class="line"><span class="section">[root@kvm-server ~]</span><span class="comment"># virsh snapshot-revert vm3 vm3-snap1</span></span><br><span class="line">æ­¤æ—¶ä½ å†çœ‹è™šæ‹ŸæœºçŠ¶æ€ï¼Œæ˜¯å¤„äºå…³é—­çŠ¶æ€</span><br><span class="line"></span><br><span class="line">åˆ é™¤è™šæ‹Ÿæœºå¿«ç…§æ“ä½œï¼š--éœ€è¦å…ˆå…³é—­è™šæ‹Ÿæœº</span><br><span class="line"><span class="section">[root@kvm-server ~]</span><span class="comment"># virsh shutdown vm3</span></span><br><span class="line"><span class="section">[root@kvm-server ~]</span><span class="comment"># virsh snapshot-list vm3</span></span><br><span class="line"> åç§°               ç”Ÿæˆæ—¶é—´              çŠ¶æ€</span><br><span class="line">------------------------------------------------------------</span><br><span class="line"> vm3-snap1            2019-10-30 15:27:15 +0800 running</span><br><span class="line"> vm3-snap2            2019-10-30 15:29:37 +0800 shutoff</span><br><span class="line"></span><br><span class="line"><span class="comment"># åˆ é™¤å¿«ç…§</span></span><br><span class="line"><span class="section">[root@kvm-server ~]</span><span class="comment"># virsh snapshot-delete --snapshotname vm3-snap2 vm3</span></span><br><span class="line">å·²åˆ é™¤åŸŸå¿«ç…§ vm2-snap3</span><br><span class="line"></span><br><span class="line"><span class="comment"># æŸ¥çœ‹éªŒè¯</span></span><br><span class="line"><span class="section">[root@kvm-server ~]</span><span class="comment"># virsh snapshot-list vm3</span></span><br><span class="line"> åç§°               ç”Ÿæˆæ—¶é—´              çŠ¶æ€</span><br><span class="line">------------------------------------------------------------</span><br><span class="line"> vm3-snap1            2019-10-30 15:27:15 +0800 running</span><br></pre></td></tr></table></figure>

<h2 id="è‡ªåŠ¨åŒ–è„šæœ¬ç®¡ç†kvm"><a href="#è‡ªåŠ¨åŒ–è„šæœ¬ç®¡ç†kvm" class="headerlink" title="è‡ªåŠ¨åŒ–è„šæœ¬ç®¡ç†kvm"></a>è‡ªåŠ¨åŒ–è„šæœ¬ç®¡ç†kvm</h2><p><code>è¿è¡Œè„šæœ¬éœ€è¦å…ˆæ›´æ”¹å¥½é…ç½®æ–‡ä»¶å†…å®¹</code></p>
<figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/bin/bash</span></span><br><span class="line"><span class="comment">#kvm batch create vm tool</span></span><br><span class="line"><span class="comment">#version:0.1</span></span><br><span class="line"><span class="comment">#time:2024-1-7</span></span><br><span class="line"><span class="comment">#author:æ¸…é£</span></span><br><span class="line"><span class="comment">#éœ€è¦äº‹å…ˆå‡†å¤‡æ¨¡æ¿é•œåƒå’Œé…ç½®æ–‡ä»¶æ¨¡æ¿</span></span><br><span class="line"></span><br><span class="line">batch_self_define() &#123;</span><br><span class="line"></span><br><span class="line">        <span class="attr">kvmname</span>=`openssl rand -hex <span class="number">5</span>`</span><br><span class="line"></span><br><span class="line">        <span class="attr">sourceimage</span>=/var/lib/libvirt/images/vmmodel.img</span><br><span class="line">        <span class="attr">sourcexml</span>=/etc/libvirt/qemu/vmmodel.xml</span><br><span class="line"></span><br><span class="line">        <span class="attr">newimg</span>=/var/lib/libvirt/images/<span class="variable">$&#123;kvmname&#125;</span>.img</span><br><span class="line">        <span class="attr">newxml</span>=/etc/libvirt/qemu/<span class="variable">$&#123;kvmname&#125;</span>.xml</span><br><span class="line"></span><br><span class="line">        cp $sourceimage  $newimg</span><br><span class="line">        cp $sourcexml $newxml</span><br><span class="line"></span><br><span class="line">        <span class="attr">kvmuuid</span>=`uuidgen`</span><br><span class="line">        <span class="attr">kvmmem</span>=<span class="variable">$&#123;1&#125;</span><span class="number">000000</span></span><br><span class="line">        <span class="attr">kvmcpu</span>=<span class="variable">$2</span></span><br><span class="line">        </span><br><span class="line">        </span><br><span class="line">        <span class="attr">kvmimg</span>=<span class="variable">$newimg</span></span><br><span class="line">        <span class="attr">kvmmac</span>=`openssl rand -hex <span class="number">3</span> | sed -r <span class="string">&#x27;s/..\B/&amp;:/g&#x27;</span>`</span><br><span class="line"></span><br><span class="line">        sed -i &quot;s@kvmname@$kvmname@<span class="comment">;s@kvmuuid@$kvmuuid@;s@kvmmem@$kvmmem@;s@kvmcpu@$kvmcpu@;s@kvmimg@$kvmimg@;s@kvmmac@$kvmmac@&quot; $newxml</span></span><br><span class="line">        virsh define $newxml</span><br><span class="line">        virsh list --all</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">self_define() &#123;</span><br><span class="line">        read -p &quot;è¯·è¾“å…¥æ–°è™šæœºåç§°:&quot; newname</span><br><span class="line">        read -p &quot;è¯·è¾“å…¥æ–°è™šæœºå†…å­˜å¤§å°(G):&quot; newmem</span><br><span class="line">        read -p &quot;è¯·è¾“å…¥æ–°è™šæœºcpuä¸ªæ•°:&quot; newcpu</span><br><span class="line"></span><br><span class="line">        <span class="attr">sourceimage</span>=/var/lib/libvirt/images/vmmodel.img</span><br><span class="line">        <span class="attr">sourcexml</span>=/etc/libvirt/qemu/vmmodel.xml</span><br><span class="line"></span><br><span class="line">        <span class="attr">newimg</span>=/var/lib/libvirt/images/<span class="variable">$&#123;newname&#125;</span>.img</span><br><span class="line">        <span class="attr">newxml</span>=/etc/libvirt/qemu/<span class="variable">$&#123;newname&#125;</span>.xml</span><br><span class="line"></span><br><span class="line">        cp $sourceimage  $newimg</span><br><span class="line">        cp $sourcexml $newxml</span><br><span class="line"></span><br><span class="line">        <span class="attr">kvmname</span>=<span class="variable">$newname</span></span><br><span class="line">        <span class="attr">kvmuuid</span>=`uuidgen`</span><br><span class="line">        <span class="attr">kvmmem</span>=<span class="variable">$&#123;newmem&#125;</span><span class="number">000000</span></span><br><span class="line">        <span class="attr">kvmcpu</span>=<span class="variable">$newcpu</span></span><br><span class="line">        <span class="attr">kvmimg</span>=<span class="variable">$newimg</span></span><br><span class="line">        <span class="attr">kvmmac</span>=`openssl rand -hex <span class="number">3</span> | sed -r <span class="string">&#x27;s/..\B/&amp;:/g&#x27;</span>`</span><br><span class="line"></span><br><span class="line">        sed -i &quot;s@kvmname@$kvmname@<span class="comment">;s@kvmuuid@$kvmuuid@;s@kvmmem@$kvmmem@;s@kvmcpu@$kvmcpu@;s@kvmimg@$kvmimg@;s@kvmmac@$kvmmac@&quot; $newxml</span></span><br><span class="line">        virsh define $newxml</span><br><span class="line">        virsh list --all</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">delete_kvm()&#123;</span><br><span class="line">        virsh list</span><br><span class="line">        while true<span class="comment">;do</span></span><br><span class="line">        read -p &quot;æ˜¯å¦éœ€è¦å…³é—­lvmæˆ–é€€å‡ºï¼ˆY/N/Tï¼‰&quot; ynt</span><br><span class="line">        if <span class="section">[ $ynt = y ]</span><span class="comment">;then</span></span><br><span class="line">                read -p &quot;è¯·è¾“å…¥ä½ è¦å…³é—­çš„kvmï¼š&quot; numb</span><br><span class="line">                virsh shutdown $numb</span><br><span class="line">        elif <span class="section">[ $ynt = n ]</span><span class="comment">;then</span></span><br><span class="line">                virsh list --all</span><br><span class="line">                read -p &quot;è¯·è¾“å…¥ä½ è¦åˆ é™¤çš„kvmï¼š&quot; num</span><br><span class="line">                virsh undefine $num</span><br><span class="line">                <span class="comment">#rm -rf /etc/libvirt/qemu/$num.xml</span></span><br><span class="line">                rm -rf /var/lib/libvirt/images/$num*</span><br><span class="line">                echo &quot;$num è™šæ‹Ÿæœºå·²è¢«åˆ é™¤ï¼&quot;</span><br><span class="line">        else</span><br><span class="line">                echo &quot;å†è§ï¼&quot;</span><br><span class="line">                break</span><br><span class="line">        fi</span><br><span class="line">        done</span><br><span class="line">&#125;  </span><br><span class="line"></span><br><span class="line">exit_menu()&#123;</span><br><span class="line">    green &quot;å†è§ï¼ï¼ï¼&quot;</span><br><span class="line">    break</span><br><span class="line">&#125;     </span><br><span class="line"></span><br><span class="line">red()&#123;</span><br><span class="line">    echo -e &quot;\033<span class="section">[31m\033[01m$1\033[0m&quot;</span></span><br><span class="line"><span class="section">&#125;</span></span><br><span class="line"><span class="section">green()&#123;</span></span><br><span class="line"><span class="section">    echo -e &quot;\033[32m\033[01m$1\033[0m&quot;</span></span><br><span class="line"><span class="section">&#125;</span></span><br><span class="line"><span class="section">yellow()&#123;</span></span><br><span class="line"><span class="section">    echo -e &quot;\033[33m\033[01m$1\033[0m&quot;</span></span><br><span class="line"><span class="section">&#125;</span></span><br><span class="line"><span class="section">blue()&#123;</span></span><br><span class="line"><span class="section">    echo -e &quot;\033[34m\033[01m$1\033[0m&quot;</span></span><br><span class="line"><span class="section">&#125;</span></span><br><span class="line"><span class="section"></span></span><br><span class="line"><span class="section"># ä¸»èœå•é€‰æ‹©</span></span><br><span class="line"><span class="section">main_menu() &#123;</span></span><br><span class="line"><span class="section">    while true; do</span></span><br><span class="line"><span class="section">red      &quot;===============================================&quot;</span></span><br><span class="line"><span class="section">green   &quot;||  ____    _____  _______  _________  _______||&quot;</span></span><br><span class="line"><span class="section">yellow  &quot;|| / __ \  /  _/ |/ / ___/ / __/ __/ |/ / ___/||&quot;</span></span><br><span class="line"><span class="section">blue    &quot;||/ /_/ / _/ //    / (_ / / _// _//    / (_ / ||&quot;</span></span><br><span class="line"><span class="section">yellow  &quot;||\___\_\/___/_/|_/\___/ /_/ /___/_/|_/\___/  ||&quot;</span></span><br><span class="line"><span class="section">green   &quot;||                                            ||&quot;</span></span><br><span class="line"><span class="section">red     &quot;===============================================&quot;</span></span><br><span class="line"><span class="section">blue    &quot;||            &gt;&gt;&gt;&gt;&gt; æ¸…é£å¾æ¥ &lt;&lt;&lt;&lt;&lt;            ||&quot;</span></span><br><span class="line"><span class="section">red     &quot;===============================================&quot;</span></span><br><span class="line"><span class="section">echo &quot;1.åˆ›å»ºè‡ªå®šä¹‰é…ç½®å•ä¸ªè™šæ‹Ÿæœº&quot;</span></span><br><span class="line"><span class="section">echo &quot;2.æ‰¹é‡åˆ›å»ºè‡ªå®šä¹‰é…ç½®è™šæ‹Ÿæœº&quot;</span></span><br><span class="line"><span class="section">echo &quot;3.æ‰¹é‡åˆ›å»ºé»˜è®¤é…ç½®è™šæ‹Ÿæœº&quot;</span></span><br><span class="line"><span class="section">echo &quot;4.åˆ é™¤è™šæ‹Ÿæœº&quot;</span></span><br><span class="line"><span class="section">echo &quot;5.é€€å‡º&quot;</span></span><br><span class="line"><span class="section">red &quot;===============================================&quot;</span></span><br><span class="line"><span class="section"></span></span><br><span class="line"><span class="section">read -p &quot;é€‰å–ä½ çš„æ“ä½œ(1/2/3/4/5):&quot; op</span></span><br><span class="line"><span class="section"></span></span><br><span class="line"><span class="section">case $op in</span></span><br><span class="line"><span class="section">1)self_define;;</span></span><br><span class="line"><span class="section">2)</span></span><br><span class="line"><span class="section">        read -p &quot;è¯·è¾“å…¥è¦åˆ›å»ºçš„è™šæ‹Ÿæœºçš„ä¸ªæ•°:&quot; num</span></span><br><span class="line"><span class="section">        read -p &quot;è¯·è¾“å…¥æ–°è™šæœºå†…å­˜å¤§å°(G):&quot; newmem</span></span><br><span class="line"><span class="section">        read -p &quot;è¯·è¾“å…¥æ–°è™šæœºcpuä¸ªæ•°:&quot; newcpu</span></span><br><span class="line"><span class="section"></span></span><br><span class="line"><span class="section">        for((i=1;i&lt;=$num;i++))</span></span><br><span class="line"><span class="section">        do</span></span><br><span class="line"><span class="section">                batch_self_define $newmem $newcpu</span></span><br><span class="line"><span class="section">        done;;</span></span><br><span class="line"><span class="section"></span></span><br><span class="line"><span class="section">3)</span></span><br><span class="line"><span class="section">        read -p &quot;è¯·è¾“å…¥è¦åˆ›å»ºçš„è™šæ‹Ÿæœºçš„ä¸ªæ•°:&quot; num</span></span><br><span class="line"><span class="section"></span></span><br><span class="line"><span class="section">        for((i=1;i&lt;=$num;i++))</span></span><br><span class="line"><span class="section">        do</span></span><br><span class="line"><span class="section">                batch_self_define 1 1</span></span><br><span class="line"><span class="section">        done;;</span></span><br><span class="line"><span class="section">4)</span></span><br><span class="line"><span class="section">        delete_kvm</span></span><br><span class="line"><span class="section">        ;;</span></span><br><span class="line"><span class="section">5)      </span></span><br><span class="line"><span class="section">        exit_menu</span></span><br><span class="line"><span class="section">        ;;</span></span><br><span class="line"><span class="section">*)</span></span><br><span class="line"><span class="section">        echo &quot;è¾“å…¥é”™è¯¯ï¼Œè¯·é‡æ–°æ‰§è¡Œè„šæœ¬&quot;</span></span><br><span class="line"><span class="section">        exit</span></span><br><span class="line"><span class="section">        ;;</span></span><br><span class="line"><span class="section">esac</span></span><br><span class="line"><span class="section"></span></span><br><span class="line"><span class="section">red &quot;===============================================&quot;</span></span><br><span class="line"><span class="section">read -p &quot;æŒ‰ä»»æ„é”®è¿”å›ä¸»èœå•&quot; any_key</span></span><br><span class="line"><span class="section">clear</span></span><br><span class="line"><span class="section">done</span></span><br><span class="line"><span class="section"></span></span><br><span class="line"><span class="section">&#125;</span></span><br><span class="line"><span class="section"></span></span><br><span class="line"><span class="section">#è¿è¡Œ</span></span><br><span class="line"><span class="section">main_menu</span></span><br></pre></td></tr></table></figure>

<h2 id="é…ç½®æ–‡ä»¶æ¨¡æ¿"><a href="#é…ç½®æ–‡ä»¶æ¨¡æ¿" class="headerlink" title="é…ç½®æ–‡ä»¶æ¨¡æ¿"></a>é…ç½®æ–‡ä»¶æ¨¡æ¿</h2><figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># vim /etc/libvirt/qemu/vmmodel.xml</span></span><br><span class="line">&lt;domain <span class="attr">type</span>=<span class="string">&#x27;kvm&#x27;</span>&gt;</span><br><span class="line">  &lt;name&gt;kvmname&lt;/name&gt;</span><br><span class="line">  &lt;uuid&gt;kvmuuid&lt;/uuid&gt;</span><br><span class="line">  &lt;memory <span class="attr">unit</span>=<span class="string">&#x27;KiB&#x27;</span>&gt;kvmmem&lt;/memory&gt;</span><br><span class="line">  &lt;currentMemory <span class="attr">unit</span>=<span class="string">&#x27;KiB&#x27;</span>&gt;kvmmem&lt;/currentMemory&gt;</span><br><span class="line">  &lt;vcpu <span class="attr">placement</span>=<span class="string">&#x27;static&#x27;</span>&gt;kvmcpu&lt;/vcpu&gt;</span><br><span class="line">  &lt;os&gt;</span><br><span class="line">    &lt;type <span class="attr">arch</span>=<span class="string">&#x27;x86_64&#x27;</span> machine=<span class="string">&#x27;pc-i440fx-rhel7.0.0&#x27;</span>&gt;hvm&lt;/type&gt;</span><br><span class="line">    &lt;boot <span class="attr">dev</span>=<span class="string">&#x27;hd&#x27;</span>/&gt;</span><br><span class="line">  &lt;/os&gt;</span><br><span class="line">  &lt;features&gt;</span><br><span class="line">    &lt;acpi/&gt;</span><br><span class="line">    &lt;apic/&gt;</span><br><span class="line">  &lt;/features&gt;</span><br><span class="line">  &lt;cpu <span class="attr">mode</span>=<span class="string">&#x27;custom&#x27;</span> match=<span class="string">&#x27;exact&#x27;</span> check=<span class="string">&#x27;partial&#x27;</span>&gt;</span><br><span class="line">    &lt;model <span class="attr">fallback</span>=<span class="string">&#x27;allow&#x27;</span>&gt;Haswell-noTSX&lt;/model&gt;</span><br><span class="line">  &lt;/cpu&gt;</span><br><span class="line">  &lt;clock <span class="attr">offset</span>=<span class="string">&#x27;utc&#x27;</span>&gt;</span><br><span class="line">    &lt;timer <span class="attr">name</span>=<span class="string">&#x27;rtc&#x27;</span> tickpolicy=<span class="string">&#x27;catchup&#x27;</span>/&gt;</span><br><span class="line">    &lt;timer <span class="attr">name</span>=<span class="string">&#x27;pit&#x27;</span> tickpolicy=<span class="string">&#x27;delay&#x27;</span>/&gt;</span><br><span class="line">    &lt;timer <span class="attr">name</span>=<span class="string">&#x27;hpet&#x27;</span> present=<span class="string">&#x27;no&#x27;</span>/&gt;</span><br><span class="line">  &lt;/clock&gt;</span><br><span class="line">  &lt;on_poweroff&gt;destroy&lt;/on_poweroff&gt;</span><br><span class="line">  &lt;on_reboot&gt;restart&lt;/on_reboot&gt;</span><br><span class="line">  &lt;on_crash&gt;destroy&lt;/on_crash&gt;</span><br><span class="line">  &lt;pm&gt;</span><br><span class="line">    &lt;suspend-to-mem <span class="attr">enabled</span>=<span class="string">&#x27;no&#x27;</span>/&gt;</span><br><span class="line">    &lt;suspend-to-disk <span class="attr">enabled</span>=<span class="string">&#x27;no&#x27;</span>/&gt;</span><br><span class="line">  &lt;/pm&gt;</span><br><span class="line">  &lt;devices&gt;</span><br><span class="line">    &lt;emulator&gt;/usr/libexec/qemu-kvm&lt;/emulator&gt;</span><br><span class="line">    &lt;disk <span class="attr">type</span>=<span class="string">&#x27;file&#x27;</span> device=<span class="string">&#x27;disk&#x27;</span>&gt;</span><br><span class="line">      &lt;driver <span class="attr">name</span>=<span class="string">&#x27;qemu&#x27;</span> type=<span class="string">&#x27;qcow2&#x27;</span>/&gt;</span><br><span class="line">      &lt;source <span class="attr">file</span>=<span class="string">&#x27;kvmimg&#x27;</span>/&gt;</span><br><span class="line">      &lt;target <span class="attr">dev</span>=<span class="string">&#x27;vda&#x27;</span> bus=<span class="string">&#x27;virtio&#x27;</span>/&gt;</span><br><span class="line">      &lt;address <span class="attr">type</span>=<span class="string">&#x27;pci&#x27;</span> domain=<span class="string">&#x27;0x0000&#x27;</span> bus=<span class="string">&#x27;0x00&#x27;</span> slot=<span class="string">&#x27;0x06&#x27;</span> function=<span class="string">&#x27;0x0&#x27;</span>/&gt;</span><br><span class="line">    &lt;/disk&gt;</span><br><span class="line">    &lt;controller <span class="attr">type</span>=<span class="string">&#x27;usb&#x27;</span> index=<span class="string">&#x27;0&#x27;</span> model=<span class="string">&#x27;ich9-ehci1&#x27;</span>&gt;</span><br><span class="line">      &lt;address <span class="attr">type</span>=<span class="string">&#x27;pci&#x27;</span> domain=<span class="string">&#x27;0x0000&#x27;</span> bus=<span class="string">&#x27;0x00&#x27;</span> slot=<span class="string">&#x27;0x04&#x27;</span> function=<span class="string">&#x27;0x7&#x27;</span>/&gt;</span><br><span class="line">    &lt;/controller&gt;</span><br><span class="line">    &lt;controller <span class="attr">type</span>=<span class="string">&#x27;usb&#x27;</span> index=<span class="string">&#x27;0&#x27;</span> model=<span class="string">&#x27;ich9-uhci1&#x27;</span>&gt;</span><br><span class="line">      &lt;master <span class="attr">startport</span>=<span class="string">&#x27;0&#x27;</span>/&gt;</span><br><span class="line">      &lt;address <span class="attr">type</span>=<span class="string">&#x27;pci&#x27;</span> domain=<span class="string">&#x27;0x0000&#x27;</span> bus=<span class="string">&#x27;0x00&#x27;</span> slot=<span class="string">&#x27;0x04&#x27;</span> function=<span class="string">&#x27;0x0&#x27;</span> multifunction=<span class="string">&#x27;on&#x27;</span>/&gt;</span><br><span class="line">    &lt;/controller&gt;</span><br><span class="line">    &lt;controller <span class="attr">type</span>=<span class="string">&#x27;usb&#x27;</span> index=<span class="string">&#x27;0&#x27;</span> model=<span class="string">&#x27;ich9-uhci2&#x27;</span>&gt;</span><br><span class="line">      &lt;master <span class="attr">startport</span>=<span class="string">&#x27;2&#x27;</span>/&gt;</span><br><span class="line">      &lt;address <span class="attr">type</span>=<span class="string">&#x27;pci&#x27;</span> domain=<span class="string">&#x27;0x0000&#x27;</span> bus=<span class="string">&#x27;0x00&#x27;</span> slot=<span class="string">&#x27;0x04&#x27;</span> function=<span class="string">&#x27;0x1&#x27;</span>/&gt;</span><br><span class="line">    &lt;/controller&gt;</span><br><span class="line">    &lt;controller <span class="attr">type</span>=<span class="string">&#x27;usb&#x27;</span> index=<span class="string">&#x27;0&#x27;</span> model=<span class="string">&#x27;ich9-uhci3&#x27;</span>&gt;</span><br><span class="line">      &lt;master <span class="attr">startport</span>=<span class="string">&#x27;4&#x27;</span>/&gt;</span><br><span class="line">      &lt;address <span class="attr">type</span>=<span class="string">&#x27;pci&#x27;</span> domain=<span class="string">&#x27;0x0000&#x27;</span> bus=<span class="string">&#x27;0x00&#x27;</span> slot=<span class="string">&#x27;0x04&#x27;</span> function=<span class="string">&#x27;0x2&#x27;</span>/&gt;</span><br><span class="line">    &lt;/controller&gt;</span><br><span class="line">    &lt;controller <span class="attr">type</span>=<span class="string">&#x27;pci&#x27;</span> index=<span class="string">&#x27;0&#x27;</span> model=<span class="string">&#x27;pci-root&#x27;</span>/&gt;</span><br><span class="line">    &lt;controller <span class="attr">type</span>=<span class="string">&#x27;virtio-serial&#x27;</span> index=<span class="string">&#x27;0&#x27;</span>&gt;</span><br><span class="line">      &lt;address <span class="attr">type</span>=<span class="string">&#x27;pci&#x27;</span> domain=<span class="string">&#x27;0x0000&#x27;</span> bus=<span class="string">&#x27;0x00&#x27;</span> slot=<span class="string">&#x27;0x05&#x27;</span> function=<span class="string">&#x27;0x0&#x27;</span>/&gt;</span><br><span class="line">    &lt;/controller&gt;</span><br><span class="line">    &lt;interface <span class="attr">type</span>=<span class="string">&#x27;network&#x27;</span>&gt;</span><br><span class="line">      &lt;mac <span class="attr">address</span>=<span class="string">&#x27;52:54:00:kvmmac&#x27;</span>/&gt;</span><br><span class="line">      &lt;source <span class="attr">network</span>=<span class="string">&#x27;default&#x27;</span>/&gt;</span><br><span class="line">      &lt;model <span class="attr">type</span>=<span class="string">&#x27;virtio&#x27;</span>/&gt;</span><br><span class="line">      &lt;address <span class="attr">type</span>=<span class="string">&#x27;pci&#x27;</span> domain=<span class="string">&#x27;0x0000&#x27;</span> bus=<span class="string">&#x27;0x00&#x27;</span> slot=<span class="string">&#x27;0x03&#x27;</span> function=<span class="string">&#x27;0x0&#x27;</span>/&gt;</span><br><span class="line">    &lt;/interface&gt;</span><br><span class="line">    &lt;serial <span class="attr">type</span>=<span class="string">&#x27;pty&#x27;</span>&gt;</span><br><span class="line">      &lt;target <span class="attr">type</span>=<span class="string">&#x27;isa-serial&#x27;</span> port=<span class="string">&#x27;0&#x27;</span>&gt;</span><br><span class="line">        &lt;model <span class="attr">name</span>=<span class="string">&#x27;isa-serial&#x27;</span>/&gt;</span><br><span class="line">      &lt;/target&gt;</span><br><span class="line">    &lt;/serial&gt;</span><br><span class="line">    &lt;console <span class="attr">type</span>=<span class="string">&#x27;pty&#x27;</span>&gt;</span><br><span class="line">      &lt;target <span class="attr">type</span>=<span class="string">&#x27;serial&#x27;</span> port=<span class="string">&#x27;0&#x27;</span>/&gt;</span><br><span class="line">    &lt;/console&gt;</span><br><span class="line">    &lt;channel <span class="attr">type</span>=<span class="string">&#x27;unix&#x27;</span>&gt;</span><br><span class="line">      &lt;target <span class="attr">type</span>=<span class="string">&#x27;virtio&#x27;</span> name=<span class="string">&#x27;org.qemu.guest_agent.0&#x27;</span>/&gt;</span><br><span class="line">      &lt;address <span class="attr">type</span>=<span class="string">&#x27;virtio-serial&#x27;</span> controller=<span class="string">&#x27;0&#x27;</span> bus=<span class="string">&#x27;0&#x27;</span> port=<span class="string">&#x27;1&#x27;</span>/&gt;</span><br><span class="line">    &lt;/channel&gt;</span><br><span class="line">    &lt;input <span class="attr">type</span>=<span class="string">&#x27;mouse&#x27;</span> bus=<span class="string">&#x27;ps2&#x27;</span>/&gt;</span><br><span class="line">    &lt;input <span class="attr">type</span>=<span class="string">&#x27;keyboard&#x27;</span> bus=<span class="string">&#x27;ps2&#x27;</span>/&gt;</span><br><span class="line">    &lt;memballoon <span class="attr">model</span>=<span class="string">&#x27;virtio&#x27;</span>&gt;</span><br><span class="line">      &lt;address <span class="attr">type</span>=<span class="string">&#x27;pci&#x27;</span> domain=<span class="string">&#x27;0x0000&#x27;</span> bus=<span class="string">&#x27;0x00&#x27;</span> slot=<span class="string">&#x27;0x07&#x27;</span> function=<span class="string">&#x27;0x0&#x27;</span>/&gt;</span><br><span class="line">    &lt;/memballoon&gt;</span><br><span class="line">  &lt;/devices&gt;</span><br><span class="line">&lt;/domain&gt;</span><br></pre></td></tr></table></figure>

<h2 id="éšæœºç”Ÿæˆmacåœ°å€"><a href="#éšæœºç”Ÿæˆmacåœ°å€" class="headerlink" title="éšæœºç”Ÿæˆmacåœ°å€"></a>éšæœºç”Ÿæˆmacåœ°å€</h2><figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">B:å­—æ¯æ•°å­—ä¸å­—æ¯æ•°å­—åˆ†å‰²ï¼Œéå­—æ¯æ•°å­—ä¸éå­—æ¯æ•°å­—åˆ†å‰²</span><br><span class="line">&amp;:è¡¨ç¤ºåŸæ¥çš„å†…å®¹</span><br><span class="line"></span><br><span class="line">å…¶ä¸­æ–¹å¼å¦‚ä¸‹ï¼š</span><br><span class="line"><span class="comment"># echo `openssl rand -hex 1`:`openssl rand -hex 1`:`openssl rand -hex 1`</span></span><br><span class="line">99:6e:67</span><br><span class="line"></span><br><span class="line"><span class="comment"># openssl rand -hex 3 | sed -r &#x27;s/(..)(..)(..)/\1:\2:\3/g&#x27;</span></span><br><span class="line">94:89:e3</span><br><span class="line"></span><br><span class="line"><span class="comment"># openssl rand -hex 3 | sed -r &#x27;s/..\B/&amp;:/g&#x27;</span></span><br><span class="line">c5:66:90</span><br><span class="line"></span><br><span class="line">å‚æ•°è§£é‡Šï¼š</span><br><span class="line">openssl rand -hex 5</span><br><span class="line">openssl rand  <span class="comment">#ç”¨æ¥ç”Ÿæˆéšæœºæ•°çš„</span></span><br><span class="line">-hex <span class="comment">#è¡¨ç¤ºä¸º16è¿›åˆ¶çš„æ•°</span></span><br><span class="line">5  <span class="comment">#è¡¨ç¤ºé•¿åº¦</span></span><br></pre></td></tr></table></figure>
<h2 id="KVMç½‘ç»œé…ç½®"><a href="#KVMç½‘ç»œé…ç½®" class="headerlink" title="KVMç½‘ç»œé…ç½®"></a>KVMç½‘ç»œé…ç½®</h2><h2 id="å››ç§ç½‘ç»œ"><a href="#å››ç§ç½‘ç»œ" class="headerlink" title="å››ç§ç½‘ç»œ"></a>å››ç§ç½‘ç»œ</h2><p><code>1.NAT defaultæ–¹å¼ï¼š</code>æ”¯æŒä¸»æœºä¸è™šæ‹Ÿæœºäº’è®¿ï¼Œè™šæ‹Ÿæœºè®¿é—®å¤–ç•Œç½‘ç»œï¼Œä½†ä¸æ”¯æŒå¤–ç•Œè®¿é—®è™šæ‹Ÿæœºã€‚<br><code>2.isolatedéš”ç¦»ï¼Œvmware--host-onlyï¼šä»…ä¸»æœºæ¨¡å¼ã€‚</code>å¤–ç½‘ä¸èƒ½è®¿é—®è™šæ‹Ÿæœºï¼Œè™šæ‹Ÿæœºä¹Ÿä¸èƒ½è®¿é—®å¤–ç½‘<br><code>3.bridge </code> â€”-æ¡¥æ¥æ¨¡å¼å±äºæ¡¥æ¥å£<br><code>4.è·¯ç”±æ¨¡å¼</code></p>
<p><strong>natç½‘ç»œ</strong></p>
<p><img src="https://xbd666.cn/upload/kvm18.webp" alt="kvm2.png"></p>
<p><strong>æ¡¥æ¥ç½‘ç»œ</strong></p>
<p><img src="https://xbd666.cn/upload/kvm19.webp" alt="kvm2.png"></p>
<p><strong>éš”ç¦»ç½‘ç»œ</strong></p>
<p><img src="https://xbd666.cn/upload/kvm20.webp" alt="kvm2.png"></p>
<figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#æŸ¥çœ‹ç®¡ç†æ¥å£å¯¹åº”çš„ç½‘å¡</span></span><br><span class="line"><span class="section">[root@kvm-server ~]</span><span class="comment"># brctl show </span></span><br><span class="line">bridge name	bridge id		STP enabled	interfaces</span><br><span class="line">virbr0		8000.525400831963	yes		virbr0-nic</span><br><span class="line">							           vnet0</span><br><span class="line">							           vnet1</span><br><span class="line"></span><br><span class="line">æ³¨æ„ï¼šè¿™é‡Œvnetç½‘å¡ï¼Œæ˜¯æ¯å°å¯åŠ¨çš„è™šæ‹Ÿæœºæ­£åœ¨ä½¿ç”¨çš„ç½‘å¡è®¾å¤‡ï¼Œæ¯å°è™šæ‹Ÿæœºä½¿ç”¨çš„ä¸åŒ			     </span><br><span class="line"><span class="comment"># ä»äº¤æ¢æœºä¸ŠæŠŠvnetç½‘å¡åˆ é™¤ï¼š</span></span><br><span class="line"><span class="section">[root@kvm-server ~]</span><span class="comment"># brctl delif virbr0 vnet0</span></span><br><span class="line"></span><br><span class="line">æ¥åˆ°vm2çš„è™šæ‹Ÿæœºï¼Œpingä¸é€šç™¾åº¦</span><br><span class="line"><span class="section">[root@kvm-server ~]</span><span class="comment"># ping baidu.com</span></span><br><span class="line">ping:baidu.com:Name or service not known</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ·»åŠ vnetç½‘å¡æ·»åŠ åˆ°äº¤æ¢æœºä¸Šï¼š</span></span><br><span class="line"><span class="section">[root@kvm-server ~]</span><span class="comment"># brctl addif virbr0 vnet0</span></span><br><span class="line">	</span><br><span class="line">æ¥åˆ°vm2çš„è™šæ‹Ÿæœºï¼Œæ¢å¤æ­£å¸¸</span><br><span class="line"><span class="section">[root@kvm-server ~]</span><span class="comment"># ping baidu.com</span></span><br><span class="line">PING www.a.shifen.com (61.135.169.125)56(84) bytes of data.</span><br><span class="line">64  bytes from 61.135.169.125(61.135.169.125): <span class="attr">icmp_seq</span>=<span class="number">1</span> ttl=<span class="number">55</span> time=<span class="number">2.24</span> ms</span><br></pre></td></tr></table></figure>

<h2 id="é…ç½®æ–‡ä»¶æ–¹å¼é…ç½®æ¡¥æ¥ï¼šåœ¨å®¿ä¸»æœºä¸Š"><a href="#é…ç½®æ–‡ä»¶æ–¹å¼é…ç½®æ¡¥æ¥ï¼šåœ¨å®¿ä¸»æœºä¸Š" class="headerlink" title="é…ç½®æ–‡ä»¶æ–¹å¼é…ç½®æ¡¥æ¥ï¼šåœ¨å®¿ä¸»æœºä¸Š"></a>é…ç½®æ–‡ä»¶æ–¹å¼é…ç½®<code>æ¡¥æ¥</code>ï¼šåœ¨å®¿ä¸»æœºä¸Š</h2><figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">é…ç½®æ–‡ä»¶æ–¹å¼é…ç½®æ¡¥æ¥ï¼šåœ¨å®¿ä¸»æœºä¸Š</span><br><span class="line"><span class="section">[root@kvm-server ~]</span><span class="comment"># ip a   #å…ˆæ‰¾å‡ºå®¿ä¸»æœºç”¨çš„å“ªä¸ªç½‘å¡è®¾å¤‡ï¼Œæˆ‘çš„æ˜¯enp0s25</span></span><br><span class="line"><span class="section">[root@kvm-server ~]</span><span class="comment"># cd /etc/sysconfig/network-scripts/</span></span><br><span class="line">1.å®šä¹‰ç½‘å¡é…ç½®æ–‡ä»¶</span><br><span class="line"><span class="section">[root@kvm-server network-scripts]</span><span class="comment"># vim ifcfg-br0    #åˆ›å»ºè¯¥æ¡¥æ¥ç½‘å¡ï¼Œé»˜è®¤æ²¡æœ‰æ­¤æ–‡ä»¶éœ€è¦æ–°å»º</span></span><br><span class="line"><span class="section">[root@kvm-server network-scripts]</span><span class="comment"># cat ifcfg-br0</span></span><br><span class="line"><span class="attr">TYPE</span>=Bridge  <span class="comment">#å®šä¹‰ç±»å‹</span></span><br><span class="line"><span class="attr">NAME</span>=br0  <span class="comment">#è®¾å¤‡çš„åå­—</span></span><br><span class="line"><span class="attr">DEVICE</span>=br0</span><br><span class="line"><span class="attr">ONBOOT</span>=<span class="string">&quot;yes&quot;</span></span><br><span class="line"><span class="attr">BOOTPROTO</span>=static</span><br><span class="line"><span class="attr">IPADDR</span>=<span class="number">10.31</span>.<span class="number">162.90</span>   <span class="comment">#è¦å’Œå®¿ä¸»æœºåœ¨ä¸€ä¸ªç½‘ç»œï¼Œè¿™é‡Œæˆ‘ç”¨çš„æ˜¯å®¿ä¸»æœºçš„ip</span></span><br><span class="line"><span class="attr">GATEWAY</span>=<span class="number">10.31</span>.<span class="number">162.1</span>   <span class="comment">#å®¿ä¸»çš„ç½‘å…³ï¼Œnatçš„æ˜¯.2,æ¡¥æ¥æ˜¯.1</span></span><br><span class="line"><span class="attr">NETMASK</span>=<span class="number">255.255</span>.<span class="number">255.0</span></span><br><span class="line"><span class="attr">DNS1</span>=<span class="number">114.144</span>.<span class="number">144.144</span></span><br><span class="line"><span class="attr">DNS2</span>=<span class="number">8.8</span>.<span class="number">8.8</span></span><br><span class="line"></span><br><span class="line">ç„¶åçœ‹æ¸…æ¥šå®¿ä¸»æœºæ­£åœ¨ä½¿ç”¨çš„ç½‘å¡ï¼Œä¿®æ”¹é…ç½®æ–‡ä»¶,(å°†ç‰©ç†æœºç½‘å¡æ¡¥åˆ°æ¡¥æ¥ç½‘å¡)</span><br><span class="line"><span class="section">[root@kvm-server network-scripts]</span><span class="comment"># cp ifcfg-enp0s25 ifcfg-enp0s25.back</span></span><br><span class="line"><span class="section">[root@kvm-server network-scripts]</span><span class="comment"># vim ifcfg-enp0s25</span></span><br><span class="line"><span class="attr">NAME</span>=enp0s25   <span class="comment">#å®šä¹‰ç½‘å¡è®¾å¤‡åç§°</span></span><br><span class="line"><span class="attr">DEVICE</span>=enp0s25   <span class="comment">#å®¿ä¸»æœºæ­£åœ¨ä½¿ç”¨çš„ç½‘å¡è®¾å¤‡</span></span><br><span class="line"><span class="attr">ONBOOT</span>=<span class="literal">yes</span></span><br><span class="line"><span class="attr">BRIDGE</span>=br0     <span class="comment">#å’Œifcfg-br0æ–‡ä»¶é‡Œé¢çš„è®¾å¤‡å¯¹åº”ï¼Œæ–°æ·»åŠ </span></span><br><span class="line">  </span><br><span class="line">2.é‡å¯libvirtdæœåŠ¡</span><br><span class="line"><span class="section">[root@kvm-server network-scripts]</span><span class="comment"># systemctl restart libvirtd </span></span><br><span class="line">3.é‡å¯networkæœåŠ¡ </span><br><span class="line"><span class="section">[root@kvm-server network-scripts]</span><span class="comment"># systemctl restart network     </span></span><br></pre></td></tr></table></figure>

<p><strong>ç„¶åå»æŸ¥çœ‹æœ‰æ²¡æœ‰æ–°è®¾å¤‡ç”Ÿæˆ</strong></p>
<p><img src="https://xbd666.cn/upload/kvm21.webp" alt="kvm2.png"></p>
<p><strong>å¯ä»¥çœ‹åˆ°ï¼Œæˆ‘ä»¬å…ˆæ·»åŠ çš„ç½‘å¡è®¾å¤‡</strong></p>
<p><img src="https://xbd666.cn/upload/kvm22.webp" alt="kvm2.png"><br><code>æ·»åŠ å®Œæˆåï¼Œè¿è¡Œè™šæ‹ŸæœºæŸ¥çœ‹IPåœ°å€ï¼Œå°±å¯ä»¥çœ‹åˆ°æ·»åŠ çš„æ¡¥æ¥ç½‘å¡äº†</code></p>
<h2 id="ç§»é™¤æ¡¥æ¥ç½‘å¡æ“ä½œ"><a href="#ç§»é™¤æ¡¥æ¥ç½‘å¡æ“ä½œ" class="headerlink" title="ç§»é™¤æ¡¥æ¥ç½‘å¡æ“ä½œ"></a>ç§»é™¤<code>æ¡¥æ¥ç½‘å¡</code>æ“ä½œ</h2><p><img src="https://xbd666.cn/upload/kvm23.webp" alt="kvm2.png"></p>
<figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">åˆ é™¤æ¡¥æ¥ç½‘å¡æ­¥éª¤ï¼š</span><br><span class="line">1.åˆ é™¤br0çš„é…ç½®æ–‡ä»¶</span><br><span class="line"><span class="section">[root@localhost ~]</span><span class="comment"># cd /etc/sysconfig/network-scripts/</span></span><br><span class="line"><span class="section">[root@localhost network-scripts]</span><span class="comment"># rm -rf ifcfg-br0 </span></span><br><span class="line"><span class="section">[root@localhost network-scripts]</span><span class="comment"># rm -rf ifcfg-ens33</span></span><br><span class="line"></span><br><span class="line">2.ä¿®æ”¹æ­£å¸¸ç½‘å¡çš„é…ç½®æ–‡ä»¶</span><br><span class="line"><span class="comment"># å°†ä¹‹å‰å¤‡ä»½çš„æ¢å¤</span></span><br><span class="line"><span class="section">[root@localhost network-scripts]</span><span class="comment"># cp ifcfg-ens33.bak ifcfg-ens33</span></span><br><span class="line">3.é‡å¯ç³»ç»Ÿ</span><br><span class="line"><span class="section">[root@localhost network-scripts]</span><span class="comment"># systemctl restart network</span></span><br><span class="line"><span class="section">[root@localhost network-scripts]</span><span class="comment"># systemctl restart libvirtd</span></span><br></pre></td></tr></table></figure>

<h2 id="é€šè¿‡é…ç½®æ–‡ä»¶æ–¹å¼åˆ›å»ºnatç½‘ç»œï¼š"><a href="#é€šè¿‡é…ç½®æ–‡ä»¶æ–¹å¼åˆ›å»ºnatç½‘ç»œï¼š" class="headerlink" title="é€šè¿‡é…ç½®æ–‡ä»¶æ–¹å¼åˆ›å»ºnatç½‘ç»œï¼š"></a>é€šè¿‡é…ç½®æ–‡ä»¶æ–¹å¼åˆ›å»ºnatç½‘ç»œï¼š</h2><figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">é…ç½®æ–‡ä»¶æ–¹å¼åˆ›å»ºnatç½‘ç»œï¼š</span><br><span class="line">1.é¦–å…ˆéœ€è¦ä¸€ä¸ªæ¨¡æ¿æ–‡ä»¶ï¼Œé€šè¿‡è¿™ä¸ªæ¨¡æ¿æ–‡ä»¶åˆ›å»ºè‡ªå®šä¹‰çš„natç½‘ç»œã€‚</span><br><span class="line"><span class="section">[root@kvm-server ~]</span><span class="comment"># cd /etc/libvirt/qemu/networks</span></span><br><span class="line"><span class="section">[root@kvm-server networks]</span><span class="comment"># ls</span></span><br><span class="line">autostar default.xml</span><br><span class="line"><span class="section">[root@kvm-server networks]</span><span class="comment"># cp default.xml nat1.xml</span></span><br><span class="line"><span class="section">[root@kvm-server networks]</span> <span class="comment"># vim nat1.xml  </span></span><br></pre></td></tr></table></figure>

<p><img src="https://xbd666.cn/upload/kvm24.webp" alt="kvm2.png"></p>
<p><strong>é‡å¯æœåŠ¡</strong></p>
<figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="section">[root@kvm-server netwoeks]</span><span class="comment"># systemctl  restart libvirtd</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#ç„¶åé€‰æ‹©ä¸€ä¸ªè™šæ‹Ÿæœºè¿›è¡Œæ·»åŠ </span></span><br><span class="line">åœ¨æŸä¸ªï¼ˆæ¯”å¦‚vm3ï¼‰è™šæ‹Ÿæœºå»æ·»åŠ æ­¤è®¾å¤‡æµ‹è¯•</span><br></pre></td></tr></table></figure>

<p><img src="https://xbd666.cn/upload/kvm25.webp" alt="kvm2.png"></p>
<p><img src="https://xbd666.cn/upload/kvm26.webp" alt="kvm2.png"></p>
<p><img src="https://xbd666.cn/upload/kvm27.webp" alt="kvm2.png"></p>
<p><img src="https://xbd666.cn/upload/kvm28.webp" alt="kvm2.png"></p>
<h2 id="åˆ›å»ºisolatedç½‘ç»œï¼Œéš”ç¦»ç½‘ç»œ"><a href="#åˆ›å»ºisolatedç½‘ç»œï¼Œéš”ç¦»ç½‘ç»œ" class="headerlink" title="åˆ›å»ºisolatedç½‘ç»œï¼Œéš”ç¦»ç½‘ç»œ"></a>åˆ›å»ºisolatedç½‘ç»œï¼Œéš”ç¦»ç½‘ç»œ</h2><figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">é…ç½®æ–‡ä»¶æ–¹å¼åˆ›å»ºisolatedç½‘ç»œéš”ç¦»ç½‘ç»œï¼š</span><br><span class="line"><span class="section">[root@kvm-server ~]</span><span class="comment"># cd /etc/libvirt/qemu/networks</span></span><br><span class="line"><span class="section">[root@kvm-server networks]</span><span class="comment"># cp default.xml isolated200.xml</span></span><br><span class="line"><span class="section">[root@kvm-server networks]</span><span class="comment"># vim isolated200.xml</span></span><br></pre></td></tr></table></figure>

<p><img src="https://xbd666.cn/upload/kvm29.webp" alt="kvm2.png"></p>
<p><strong>å¯åŠ¨ï¼š</strong></p>
<figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="section">[root@kvm-server networks]</span><span class="comment"># systemctl restart libvirtd</span></span><br><span class="line">å¼€æœºè‡ªå¯åŠ¨:</span><br><span class="line"><span class="section">[root@kvm-server networks]</span><span class="comment"># virsh net-autostart  isolated200</span></span><br><span class="line"></span><br><span class="line">æŸ¥çœ‹æ‰€æœ‰çš„ç½‘ç»œï¼š</span><br><span class="line"><span class="section">[root@kvm-server networks]</span><span class="comment"># virsh net-list</span></span><br></pre></td></tr></table></figure>

<p><img src="https://xbd666.cn/upload/kvm30.webp" alt="kvm2.png"></p>
<h2 id="å›¾æ–‡æ–¹å¼åˆ›å»ºnatç½‘ç»œ"><a href="#å›¾æ–‡æ–¹å¼åˆ›å»ºnatç½‘ç»œ" class="headerlink" title="å›¾æ–‡æ–¹å¼åˆ›å»ºnatç½‘ç»œ"></a>å›¾æ–‡æ–¹å¼åˆ›å»ºnatç½‘ç»œ</h2><p><img src="https://xbd666.cn/upload/kvm31.webp" alt="kvm2.png"></p>
<p><img src="https://xbd666.cn/upload/kvm32.webp" alt="kvm2.png"></p>
<p><img src="https://xbd666.cn/upload/kvm33.webp" alt="kvm2.png"></p>
<p><img src="https://xbd666.cn/upload/kvm34.webp" alt="kvm2.png"></p>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>æ–‡ç« ä½œè€…: </span><span class="post-copyright-info"><a href="https://7dong.dpdns.org">Mr.xu</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>æ–‡ç« é“¾æ¥: </span><span class="post-copyright-info"><a href="https://7dong.dpdns.org/2025/11/06/KVM-%E8%99%9A%E6%8B%9F%E6%9C%BA%E9%83%A8%E7%BD%B2/">https://7dong.dpdns.org/2025/11/06/KVM-%E8%99%9A%E6%8B%9F%E6%9C%BA%E9%83%A8%E7%BD%B2/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>ç‰ˆæƒå£°æ˜: </span><span class="post-copyright-info">æœ¬åšå®¢æ‰€æœ‰æ–‡ç« é™¤ç‰¹åˆ«å£°æ˜å¤–ï¼Œå‡é‡‡ç”¨ <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> è®¸å¯åè®®ã€‚è½¬è½½è¯·æ³¨æ˜æ¥æº <a href="https://7dong.dpdns.org" target="_blank">Dong_Blog</a>ï¼</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/Linux/">Linux</a><a class="post-meta__tags" href="/tags/KVM/">KVM</a></div><div class="post-share"><div class="social-share" data-image="/img/picture/28.jpg" data-sites="facebook,x,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.6/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.6/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><a class="pagination-related" href="/2025/11/06/Grafana%E5%92%8CPrometheus%E7%9A%84%E9%83%A8%E7%BD%B2%E5%AE%89%E8%A3%85/" title="Grafanaå’ŒPrometheusçš„éƒ¨ç½²å®‰è£…"><img class="cover" src="/img/picture/17.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="info"><div class="info-1"><div class="info-item-1">ä¸Šä¸€ç¯‡</div><div class="info-item-2">Grafanaå’ŒPrometheusçš„éƒ¨ç½²å®‰è£…</div></div><div class="info-2"><div class="info-item-1">Grafanaå’ŒPrometheusçš„æ­å»ºæœåŠ¡ç«¯é¦–å…ˆæ­å»ºPrometheus æœåŠ¡ç«¯åœ¨å®˜ç½‘ä¸‹è½½ æˆ–è€…ä¹Ÿå¯ä»¥åœ¨æˆ‘çš„äº‘ç›˜ç›´æ¥ä¸‹è½½1wget https://a.xbd666.cn/d/Aliyun/Cloud_computing/Software_package/prometheus-Grafana/prometheus-2.47.2.linux-amd64.tar.gz  ä¸‹è½½åˆ°æœåŠ¡å™¨åè§£å‹å‡ºæ¥1234[root@localhost ~]# tar xvf prometheus-2.47.2.linux-amd64.tar.gz -C /usr/local/prometheus[root@localhost ~]# cd /usr/local/prometheus[root@localhost prometheus]# useradd prometheus -s /usr/sbin/nologin[root@localhost prometheus]# chown -R prometheus.prometheus ./*  è¿›å…¥ç›®å½•åç¼–è¾‘é…ç½®æ–‡ä»¶ï¼Œéœ€è¦æ”¹åŠ¨çš„æ˜¯æœ€åå‡ è¡Œï¼Œæ˜¯æ·»åŠ å…¶ä»–èŠ‚...</div></div></div></a><a class="pagination-related" href="/2025/11/06/%E5%B8%B8%E7%94%A8%E7%9A%84linux%E5%91%BD%E4%BB%A4/" title="å¸¸ç”¨çš„linuxå‘½ä»¤"><img class="cover" src="/img/picture/14.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="info text-right"><div class="info-1"><div class="info-item-1">ä¸‹ä¸€ç¯‡</div><div class="info-item-2">å¸¸ç”¨çš„linuxå‘½ä»¤</div></div><div class="info-2"><div class="info-item-1">æ¸…ç†linuxç³»ç»Ÿä¸­çš„ç¼“å­˜(ç”Ÿäº§ç¯å¢ƒæ…ç”¨!)1echo 3 &gt; /proc/sys/vm/drop_caches drop_caches æ–‡ä»¶å…è®¸ä¸‰ä¸ªä¸åŒçš„å€¼ï¼š 1: åªæ¸…ç©ºé¡µé¢ç¼“å­˜ã€‚ 2: åªæ¸…ç©ºç›®å½•é¡¹å’Œinodeã€‚ 3: æ¸…ç©ºé¡µé¢ç¼“å­˜ã€ç›®å½•é¡¹å’Œinodeã€‚ æ¯”è¾ƒæ–‡ä»¶å†…å®¹å·®å¼‚123diff a.txt b.txt     #æ­£å¸¸æ¯”è¾ƒdiff -c a.txt b.txt    #ä»¥ä¸Šä¸‹æ–‡æ–¹å¼æ¯”è¾ƒdiff -u a.txt b.txt    #è”åˆæ–¹å¼æ¯”è¾ƒ  æŸ¥çœ‹æ“ä½œç³»ç»Ÿç‰ˆæœ¬ä¿¡æ¯1cat /etc/redhat-release  ç»Ÿè®¡å‡ºç°ç›¸åŒè¡Œçš„æ¬¡æ•°1uniq -c  æ ‡å‡†é”™è¯¯é‡å®šå‘åˆ°æ ‡å‡†è¾“å‡ºçš„ä½ç½®2 æ˜¯æ ‡å‡†é”™è¯¯çš„æ–‡ä»¶æè¿°ç¬¦ï¼Œ1 æ˜¯æ ‡å‡†è¾“å‡ºçš„æ–‡ä»¶æè¿°ç¬¦ã€‚è€Œ &gt;&amp; è¡¨ç¤ºå°†ä¸€ä¸ªæ–‡ä»¶æè¿°ç¬¦é‡å®šå‘åˆ°å¦ä¸€ä¸ªæ–‡ä»¶æè¿°ç¬¦ï¼Œ1 è¡¨ç¤ºæ ‡å‡†è¾“å‡ºã€‚å› æ­¤ï¼Œ2&gt;&amp;1 å°±è¡¨ç¤ºå°†æ ‡å‡†é”™è¯¯é‡å®šå‘åˆ°æ ‡å‡†è¾“å‡ºçš„ä½ç½® è¦åœ¨Linuxç³»ç»Ÿä¸­æ·»åŠ ä¸€ä¸ªHTTPä»£ç†ï¼Œå¯ä»¥æŒ‰ç…§ä»¥ä¸‹æ­¥éª¤è¿›è¡Œæ“ä½œï¼š12345678910#ä»£ç†å…ˆåœ¨Clashä¸Šå¼€å¯Allow LAN,å¹¶è®¾ç½®ä»£ç†ç«¯å£8888# åœ¨ç»ˆç«¯...</div></div></div></a></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>ç›¸å…³æ¨è</span></div><div class="relatedPosts-list"><a class="pagination-related" href="/2026/02/04/Vercel%E9%83%A8%E7%BD%B2Twikoo%E8%AF%84%E8%AE%BA%E7%B3%BB%E7%BB%9F/" title="Verceléƒ¨ç½²Twikooè¯„è®ºç³»ç»Ÿ"><img class="cover" src="/img/picture/20.jpg" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2026-02-04</div><div class="info-item-2">Verceléƒ¨ç½²Twikooè¯„è®ºç³»ç»Ÿ</div></div><div class="info-2"><div class="info-item-1">Twikooç®€ä»‹Twikooæ˜¯ä¸€ä¸ªç®€æ´ã€å®‰å…¨ã€å…è´¹çš„é™æ€ç½‘ç«™è¯„è®ºç³»ç»Ÿã€‚ ä¸walineç›¸æ¯”ï¼šä¼˜åŠ¿ï¼šå·®ä¸å¤šï¼›ä¸è¶³ï¼šä¸æ”¯æŒIEï¼Œç§æœ‰éƒ¨ç½²éœ€è¦é…ç½®å›¾åºŠã€‚ 1. åˆ›å»ºMongoDB Cloudæ•°æ®åº“(1) æ·»åŠ Userç™»å½•MongoDB Cloudå®˜ç½‘åœ°å€(æ²¡è´¦å·éœ€è¦å…ˆæ³¨å†Œ)ï¼Œåœ¨Database Accessé¡µé¢ç‚¹å‡»Add New Database Useråˆ›å»ºæ•°æ®åº“ç”¨æˆ·ï¼ŒAuthentication Methodé€‰Passwordï¼Œåœ¨Password Authenticationä¸‹è®¾ç½®æ•°æ®åº“ç”¨æˆ·åå’Œå¯†ç ï¼Œç”¨æˆ·åå’Œå¯†ç å¯åŒ…å«æ•°å­—å’Œå¤§å°å†™å­—æ¯ï¼Œä¸èƒ½åŒ…å«ç‰¹æ®Šç¬¦å·ã€‚ç‚¹å‡»Database User Privilegesä¸‹æ–¹çš„Add Built In Roleï¼Œelect Roleé€‰æ‹©Atlas Adminï¼Œæœ€åç‚¹å‡»Add User  (2) æ·»åŠ Network Accessåœ¨Network Accessé¡µé¢ç‚¹å‡»Add IP Addressï¼ŒAccess List Entryè¾“å…¥0.0.0.0&#x2F;0(å…è®¸æ‰€æœ‰IPåœ°å€çš„è¿æ¥)ï¼Œç‚¹å‡»Confirm 2. Verceléƒ¨ç½²Twikoo(1) ä¸€...</div></div></div></a><a class="pagination-related" href="/2025/11/06/k8s-web%E5%B9%B3%E5%8F%B0%E9%83%A8%E7%BD%B2/" title="k8s--webå¹³å°éƒ¨ç½²"><img class="cover" src="/img/picture/3.jpg" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-11-06</div><div class="info-item-2">k8s--webå¹³å°éƒ¨ç½²</div></div><div class="info-2"><div class="info-item-1">æŸ¥çœ‹é›†ç¾¤æœ‰æ²¡æœ‰å¯åŠ¨æ­£å¸¸123[root@k8s-1 k8s]# kubectl get node[root@k8s-1 k8s]# kubectl get pod -A    åˆ›å»ºç›®å½•1mkdir k8s &amp;&amp;  cd k8s    ä¸‹è½½å®˜æ–¹yamlæ–‡ä»¶1wget https://raw.githubusercontent.com/kubernetes/dashboard/v2.7.0/aio/deploy/recommended.yaml    æŸ¥çœ‹å¹¶åˆ›å»º123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122...</div></div></div></a><a class="pagination-related" href="/2025/11/06/Nginx-%E5%AE%9E%E7%8E%B0%E5%8A%A8%E9%9D%99%E5%88%86%E7%A6%BB/" title="Nginx å®ç°åŠ¨é™åˆ†ç¦»å®éªŒ"><img class="cover" src="/img/picture/15.jpg" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-11-06</div><div class="info-item-2">Nginx å®ç°åŠ¨é™åˆ†ç¦»å®éªŒ</div></div><div class="info-2"><div class="info-item-1">nginx å®ç°åŠ¨é™åˆ†ç¦»å‡†å¤‡ç¯å¢ƒ å‡†å¤‡3å°æœºå™¨ï¼Œä¸€ä¸ªnginxä»£ç† ä¸¤ä¸ªhttp åˆ†åˆ«å¤„ç†åŠ¨æ€å’Œé™æ€ expiresåŠŸèƒ½è¯´æ˜ 1å½“nginxè®¾ç½®äº†expiresåï¼Œä¾‹å¦‚è®¾ç½®ä¸ºï¼šexpires 10d; é‚£ä¹ˆç”¨æˆ·åœ¨10å¤©å†…è¯·æ±‚çš„æ—¶å€™ï¼Œéƒ½åªä¼šè®¿é—®æµè§ˆå™¨ä¸­çš„ç¼“å­˜ï¼Œè€Œä¸ä¼šå»è¯·æ±‚nginxã€‚  1ã€é™æ€èµ„æºé…ç½®12345678910server &#123;        listen 80;        server_name     localhost;        location ~ \.(html|jpg|png|js|css) &#123;        root /home/www/nginx;        expires      1d; #ä¸ºå®¢æˆ·ç«¯è®¾ç½®é™æ€èµ„æºç¼“å­˜æ—¶é—´        &#125;&#125;  æµ‹è¯• 1234curl -I http://192.168.116.111/test.jpgHTTP/1.1 200 OK		//æ˜¾ç¤º200ï¼Œä»£è¡¨æˆåŠŸ# ä¹Ÿå¯ä»¥åœ¨ç½‘å€è®¿é—®ï¼š192.168.116.111/test.jpg  2ã€åŠ¨æ€èµ„æºé…ç½®yum å®‰è£…php7...</div></div></div></a><a class="pagination-related" href="/2025/11/06/zabbix-proxy%E9%85%8D%E7%BD%AE%E5%8F%8A%E9%82%AE%E4%BB%B6%E9%85%8D%E7%BD%AE/" title="zabbix-proxyé…ç½®åŠé‚®ä»¶é…ç½®"><img class="cover" src="/img/picture/17.jpg" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-11-06</div><div class="info-item-2">zabbix-proxyé…ç½®åŠé‚®ä»¶é…ç½®</div></div><div class="info-2"><div class="info-item-1">ä¸€ã€ä¸‹è½½é…ç½®serverï¼Œagentç«¯ä¸‹è½½zabbix-serverï¼Œserverå®¢æˆ·ç«¯1234567891011121314151617# å¤‡æ³¨ï¼šzabbixæºä¸èƒ½å’ŒepelæºåŒæ—¶å­˜åœ¨ï¼Œè¦ç»™epelæºæ³¨é‡Šäº†# æ›´æ–°ä¸‹è½½zabbixæº[root@zabbix-server ~]# rpm -Uvh https://repo.zabbix.com/zabbix/5.0/rhel/7/x86_64/zabbix-release-5.0-1.el7.noarch.rpm# æ›´æ–°yumä»“åº“[root@zabbix-server ~]# yum clean all[root@zabbix-server ~]# yum repolist# å®‰è£…å®‰è£… zabbix rpm æº,é‰´äºå›½å†…ç½‘ç»œæƒ…å†µï¼Œä½¿ç”¨é˜¿é‡Œäº‘ zabbix æº# æ›´æ¢æº[root@zabbix-server ~]# sed -i &#x27;s#http://repo.zabbix.com#https://mirrors.aliyun.com/zabbix#&#x27; /etc/yum.repos.d/zabbix.repo# ...</div></div></div></a><a class="pagination-related" href="/2025/11/06/docker-harbor%E7%A7%81%E6%9C%89%E4%BB%93%E5%BA%93%E9%83%A8%E7%BD%B2/" title="docker--harborç§æœ‰ä»“åº“éƒ¨ç½²"><img class="cover" src="/img/picture/20.jpg" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-11-06</div><div class="info-item-2">docker--harborç§æœ‰ä»“åº“éƒ¨ç½²</div></div><div class="info-2"><div class="info-item-1">éƒ¨ç½²harborâ€“æ–¹å¼ä¸€éƒ¨ç½²ç¯å¢ƒ  å…³é—­é˜²ç«å¢™ ä¸‹è½½harboråŒ…1wget https://a.xbd666.cn/d/Aliyun/Cloud_computing/Software_package/docker/harbor-online-installer-v2.10.0.tgz ä¸‹è½½docker-compose1curl -L https://github.com/docker/compose/releases/download/1.22.0/docker-compose-`uname -s`-`uname -m` -o /usr/local/bin/docker-compose æˆæƒ1[root@iZ8vb3lp570ckxi53yb66gZ ~]# chmod +x /usr/local/bin/docker-compose è§£å‹12[root@kub-k8s-master ~]# tar xf harbor-offline-installer-v1.8.0.tgz[root@kub-k8s-master ~]# cd harbor httpè®¿é—®æ–¹å¼çš„é…ç½®ï¼š12345...</div></div></div></a><a class="pagination-related" href="/2025/11/06/ChatGPT%E9%83%A8%E7%BD%B2/" title="ChatGPTéƒ¨ç½²"><img class="cover" src="/img/picture/26.jpg" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-11-06</div><div class="info-item-2">ChatGPTéƒ¨ç½²</div></div><div class="info-2"><div class="info-item-1">å…è´¹ä½¿ç”¨ChatGPTï¼Œç½‘é¡µç‰ˆéƒ¨ç½² APIå®˜ç½‘ï¼šhttps://api1.chenjianming.fun GitHubå®˜ç½‘ï¼šhttps://github.com  vercelå®˜ç½‘ï¼šhttps://vercel.com  ç™»å…¥githubï¼Œç‚¹å‡»æœç´¢chatï¼Œç‚¹ç¬¬äºŒä¸ªé¡¹ç›®https://github.com/xubaodong0511/ChatGPT-Next-Web ç‚¹å‡»Forkåˆ°è‡ªå·±ä»“åº“https://vercel.com/new/xubaodong0511s-projects æ‰“å¼€ç½‘ç«™vercel.com ç‚¹å‡»æ–°å»ºé¡¹ç›® å¯ä»¥çœ‹åˆ°åˆšåˆšForkçš„ä»“åº“ ç‚¹å‡»importå¯¼å…¥ é‡æ–°æ„å»ºä¸€ä¸ªé¡¹ç›®åå­—ï¼Œä¸ç„¶ä¸ä¼šåˆ†é…å…è´¹çš„åŸŸå ç‚¹å‡»Environment Variables  Environment Variables(ç¯å¢ƒå˜é‡)æ­¥éª¤â€”ç›´æ¥å¤åˆ¶ä¸‹é¢å†…å®¹ BASE_URL https://api1.chenjianming.fun ç‚¹å‡»add  åˆ›å»ºä»¤ç‰Œå¯†é’¥æ­¥éª¤ https://api1.chenjianming.fun ç‚¹å‡»å¯†é’¥ï¼Œåˆ›å»ºâ€”-è®¾ç½®åç§°ï¼Œæ°¸ä¸è¿‡æœŸï¼Œè®¾ä¸ºæ— é™é¢åº¦ æäº¤ å›åˆ°Env...</div></div></div></a></div></div><hr class="custom-hr"/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> è¯„è®º</span></div></div><div class="comment-wrap"><div><div id="twikoo-wrap"></div></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info text-center"><div class="avatar-img"><img src="/img/dong.png" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info-name">Mr.xu</div><div class="author-info-description"></div><div class="site-data"><a href="/archives/"><div class="headline">æ–‡ç« </div><div class="length-num">82</div></a><a href="/tags/"><div class="headline">æ ‡ç­¾</div><div class="length-num">46</div></a><a href="/categories/"><div class="headline">åˆ†ç±»</div><div class="length-num">1</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/xubaodong0511"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-author-social"><a href="https://github.com/xubaodong0511" target="_blank" rel="noopener"><i class="fab fa-github"></i></a><a href="https://gitee.com/xbd666" target="_blank" rel="noopener"><i class="fab fa-gitee"></i></a><a href="https://www.bilibili.com/" target="_blank" rel="noopener"><i class="fab fa-bilibili"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>å…¬å‘Š</span></div><div class="announcement_content">ç›¸é‡å³æ˜¯ç¼˜ã€‚</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>ç›®å½•</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BB%80%E4%B9%88%E6%98%AF%E8%99%9A%E6%8B%9F%E5%8C%96"><span class="toc-number">1.</span> <span class="toc-text">ä»€ä¹ˆæ˜¯è™šæ‹ŸåŒ–:</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%99%9A%E6%8B%9F%E5%8C%96%E4%BA%A7%E5%93%81%E5%88%86%E7%B1%BB"><span class="toc-number">2.</span> <span class="toc-text">è™šæ‹ŸåŒ–äº§å“åˆ†ç±»:</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%99%9A%E6%8B%9F%E5%8C%96%E4%BA%A7%E5%93%81%E5%88%86%E7%B1%BB%EF%BC%9A"><span class="toc-number">3.</span> <span class="toc-text">è™šæ‹ŸåŒ–äº§å“åˆ†ç±»ï¼š</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%83%A8%E7%BD%B2"><span class="toc-number">4.</span> <span class="toc-text">éƒ¨ç½²</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%9E%84%E5%BB%BA%E7%8E%AF%E5%A2%83"><span class="toc-number">5.</span> <span class="toc-text">æ„å»ºç¯å¢ƒ</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%9B%BE%E5%BD%A2%E6%B7%BB%E5%8A%A0%E8%99%9A%E6%8B%9F%E6%9C%BA"><span class="toc-number">6.</span> <span class="toc-text">å›¾å½¢æ·»åŠ è™šæ‹Ÿæœº</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%96%87%E6%9C%AC%E6%B7%BB%E5%8A%A0%E8%99%9A%E6%8B%9F%E6%9C%BA"><span class="toc-number">7.</span> <span class="toc-text">æ–‡æœ¬æ·»åŠ è™šæ‹Ÿæœº</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%A8%A1%E6%9D%BF%E9%95%9C%E5%83%8F-%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6-%E6%96%B9%E5%BC%8F%E5%AE%89%E8%A3%85%E8%99%9A%E6%8B%9F%E6%9C%BA%E2%80%94%E9%87%8D%E7%82%B9"><span class="toc-number">8.</span> <span class="toc-text">æ¨¡æ¿é•œåƒ+é…ç½®æ–‡ä»¶ æ–¹å¼å®‰è£…è™šæ‹Ÿæœºâ€”é‡ç‚¹</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#KVM%E8%99%9A%E6%8B%9F%E6%9C%BA%E7%AE%A1%E7%90%86"><span class="toc-number">9.</span> <span class="toc-text">KVMè™šæ‹Ÿæœºç®¡ç†</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%99%9A%E6%8B%9F%E6%9C%BA%E6%B7%BB%E5%8A%A0%E8%AE%BE%E5%A4%87"><span class="toc-number">10.</span> <span class="toc-text">è™šæ‹Ÿæœºæ·»åŠ è®¾å¤‡</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%99%9A%E6%8B%9F%E6%9C%BA%E5%85%8B%E9%9A%86"><span class="toc-number">11.</span> <span class="toc-text">è™šæ‹Ÿæœºå…‹éš†</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#kvm%E9%AB%98%E7%BA%A7%E5%91%BD%E4%BB%A4"><span class="toc-number">12.</span> <span class="toc-text">kvmé«˜çº§å‘½ä»¤</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%BB%BA%E7%AB%8Bqcow2%E6%A0%BC%E5%BC%8F%E7%A3%81%E7%9B%98%E6%96%87%E4%BB%B6"><span class="toc-number">13.</span> <span class="toc-text">å»ºç«‹qcow2æ ¼å¼ç£ç›˜æ–‡ä»¶</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%8C%82%E8%BD%BD%E7%A3%81%E7%9B%98"><span class="toc-number">14.</span> <span class="toc-text">æŒ‚è½½ç£ç›˜</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#KVM%E5%AD%98%E5%82%A8%E9%85%8D%E7%BD%AE"><span class="toc-number">15.</span> <span class="toc-text">KVMå­˜å‚¨é…ç½®</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#kvm%E5%BF%AB%E7%85%A7"><span class="toc-number">16.</span> <span class="toc-text">kvmå¿«ç…§</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%87%AA%E5%8A%A8%E5%8C%96%E8%84%9A%E6%9C%AC%E7%AE%A1%E7%90%86kvm"><span class="toc-number">17.</span> <span class="toc-text">è‡ªåŠ¨åŒ–è„šæœ¬ç®¡ç†kvm</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6%E6%A8%A1%E6%9D%BF"><span class="toc-number">18.</span> <span class="toc-text">é…ç½®æ–‡ä»¶æ¨¡æ¿</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%9A%8F%E6%9C%BA%E7%94%9F%E6%88%90mac%E5%9C%B0%E5%9D%80"><span class="toc-number">19.</span> <span class="toc-text">éšæœºç”Ÿæˆmacåœ°å€</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#KVM%E7%BD%91%E7%BB%9C%E9%85%8D%E7%BD%AE"><span class="toc-number">20.</span> <span class="toc-text">KVMç½‘ç»œé…ç½®</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%9B%9B%E7%A7%8D%E7%BD%91%E7%BB%9C"><span class="toc-number">21.</span> <span class="toc-text">å››ç§ç½‘ç»œ</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6%E6%96%B9%E5%BC%8F%E9%85%8D%E7%BD%AE%E6%A1%A5%E6%8E%A5%EF%BC%9A%E5%9C%A8%E5%AE%BF%E4%B8%BB%E6%9C%BA%E4%B8%8A"><span class="toc-number">22.</span> <span class="toc-text">é…ç½®æ–‡ä»¶æ–¹å¼é…ç½®æ¡¥æ¥ï¼šåœ¨å®¿ä¸»æœºä¸Š</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%A7%BB%E9%99%A4%E6%A1%A5%E6%8E%A5%E7%BD%91%E5%8D%A1%E6%93%8D%E4%BD%9C"><span class="toc-number">23.</span> <span class="toc-text">ç§»é™¤æ¡¥æ¥ç½‘å¡æ“ä½œ</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%80%9A%E8%BF%87%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6%E6%96%B9%E5%BC%8F%E5%88%9B%E5%BB%BAnat%E7%BD%91%E7%BB%9C%EF%BC%9A"><span class="toc-number">24.</span> <span class="toc-text">é€šè¿‡é…ç½®æ–‡ä»¶æ–¹å¼åˆ›å»ºnatç½‘ç»œï¼š</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%88%9B%E5%BB%BAisolated%E7%BD%91%E7%BB%9C%EF%BC%8C%E9%9A%94%E7%A6%BB%E7%BD%91%E7%BB%9C"><span class="toc-number">25.</span> <span class="toc-text">åˆ›å»ºisolatedç½‘ç»œï¼Œéš”ç¦»ç½‘ç»œ</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%9B%BE%E6%96%87%E6%96%B9%E5%BC%8F%E5%88%9B%E5%BB%BAnat%E7%BD%91%E7%BB%9C"><span class="toc-number">26.</span> <span class="toc-text">å›¾æ–‡æ–¹å¼åˆ›å»ºnatç½‘ç»œ</span></a></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>æœ€æ–°æ–‡ç« </span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2026/02/04/Vercel%E9%83%A8%E7%BD%B2Twikoo%E8%AF%84%E8%AE%BA%E7%B3%BB%E7%BB%9F/" title="Verceléƒ¨ç½²Twikooè¯„è®ºç³»ç»Ÿ"><img src="/img/picture/20.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Verceléƒ¨ç½²Twikooè¯„è®ºç³»ç»Ÿ"/></a><div class="content"><a class="title" href="/2026/02/04/Vercel%E9%83%A8%E7%BD%B2Twikoo%E8%AF%84%E8%AE%BA%E7%B3%BB%E7%BB%9F/" title="Verceléƒ¨ç½²Twikooè¯„è®ºç³»ç»Ÿ">Verceléƒ¨ç½²Twikooè¯„è®ºç³»ç»Ÿ</a><time datetime="2026-02-04T05:49:39.000Z" title="å‘è¡¨äº 2026-02-04 13:49:39">2026-02-04</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2025/11/06/docker-%E5%88%9B%E5%BB%BAhalo%E5%8D%9A%E5%AE%A2/" title="docker åˆ›å»ºhaloåšå®¢"><img src="/img/picture/6.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="docker åˆ›å»ºhaloåšå®¢"/></a><div class="content"><a class="title" href="/2025/11/06/docker-%E5%88%9B%E5%BB%BAhalo%E5%8D%9A%E5%AE%A2/" title="docker åˆ›å»ºhaloåšå®¢">docker åˆ›å»ºhaloåšå®¢</a><time datetime="2025-11-06T13:17:32.000Z" title="å‘è¡¨äº 2025-11-06 21:17:32">2025-11-06</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2025/11/06/Centos%E7%BD%91%E5%8D%A1%E9%85%8D%E7%BD%AE/" title="Centosç½‘å¡é…ç½®"><img src="/img/picture/3.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Centosç½‘å¡é…ç½®"/></a><div class="content"><a class="title" href="/2025/11/06/Centos%E7%BD%91%E5%8D%A1%E9%85%8D%E7%BD%AE/" title="Centosç½‘å¡é…ç½®">Centosç½‘å¡é…ç½®</a><time datetime="2025-11-06T13:16:51.000Z" title="å‘è¡¨äº 2025-11-06 21:16:51">2025-11-06</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2025/11/06/shell%E6%B7%BB%E5%8A%A0%E7%94%A8%E6%88%B7%EF%BC%8C%E8%AE%A1%E7%AE%97%EF%BC%8Cvsftp/" title="shellæ·»åŠ ç”¨æˆ·ï¼Œè®¡ç®—ï¼Œvsftp"><img src="/img/picture/18.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="shellæ·»åŠ ç”¨æˆ·ï¼Œè®¡ç®—ï¼Œvsftp"/></a><div class="content"><a class="title" href="/2025/11/06/shell%E6%B7%BB%E5%8A%A0%E7%94%A8%E6%88%B7%EF%BC%8C%E8%AE%A1%E7%AE%97%EF%BC%8Cvsftp/" title="shellæ·»åŠ ç”¨æˆ·ï¼Œè®¡ç®—ï¼Œvsftp">shellæ·»åŠ ç”¨æˆ·ï¼Œè®¡ç®—ï¼Œvsftp</a><time datetime="2025-11-06T13:13:49.000Z" title="å‘è¡¨äº 2025-11-06 21:13:49">2025-11-06</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2025/11/06/%E7%B3%BB%E7%BB%9F%E5%B7%A5%E5%85%B7%E7%AE%B1-%E8%84%9A%E6%9C%AC/" title="ç³»ç»Ÿå·¥å…·ç®±--è„šæœ¬"><img src="/img/picture/14.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="ç³»ç»Ÿå·¥å…·ç®±--è„šæœ¬"/></a><div class="content"><a class="title" href="/2025/11/06/%E7%B3%BB%E7%BB%9F%E5%B7%A5%E5%85%B7%E7%AE%B1-%E8%84%9A%E6%9C%AC/" title="ç³»ç»Ÿå·¥å…·ç®±--è„šæœ¬">ç³»ç»Ÿå·¥å…·ç®±--è„šæœ¬</a><time datetime="2025-11-06T13:13:16.000Z" title="å‘è¡¨äº 2025-11-06 21:13:16">2025-11-06</time></div></div></div></div></div></div></main><footer id="footer"><div class="footer-other"><div class="footer-copyright"><span class="copyright">Â©Â 2025 - 2026 By <span class="copyright-author">Mr.xu</span></span><span class="framework-info"><span>æ¡†æ¶ </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo 7.3.0</a><span class="footer-separator">|</span><span>ä¸»é¢˜ </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly 5.5.3</a></span></div></div><script src="/js/snow.js"></script></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="é˜…è¯»æ¨¡å¼"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="æ—¥é—´å’Œå¤œé—´æ¨¡å¼åˆ‡æ¢"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="å•æ å’ŒåŒæ åˆ‡æ¢"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="readmode" type="button" title="é˜…è¯»æ¨¡å¼"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="æ—¥é—´å’Œå¤œé—´æ¨¡å¼åˆ‡æ¢"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="å•æ å’ŒåŒæ åˆ‡æ¢"><i class="fas fa-arrows-alt-h"></i></button><button id="go-up" type="button" title="å›åˆ°é¡¶éƒ¨"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js?v=5.5.3"></script><script src="/js/main.js?v=5.5.3"></script><div class="js-pjax"><script>(() => {
  const isShuoshuo = GLOBAL_CONFIG_SITE.pageType === 'shuoshuo'
  const option = null

  const getCount = () => {
    const countELement = document.getElementById('twikoo-count')
    if(!countELement) return
    twikoo.getCommentsCount({
      envId: 'https://hexoblogtwikoovercel.vercel.app',
      region: '',
      urls: [window.location.pathname],
      includeReply: false
    }).then(res => {
      countELement.textContent = res[0].count
    }).catch(err => {
      console.error(err)
    })
  }

  const init = (el = document, path = location.pathname) => {
    twikoo.init({
      el: el.querySelector('#twikoo-wrap'),
      envId: 'https://hexoblogtwikoovercel.vercel.app',
      region: '',
      onCommentLoaded: () => {
        btf.loadLightbox(document.querySelectorAll('#twikoo .tk-content img:not(.tk-owo-emotion)'))
      },
      ...option,
      path: isShuoshuo ? path : (option && option.path) || path
    })

    

    isShuoshuo && (window.shuoshuoComment.destroyTwikoo = () => {
      if (el.children.length) {
        el.innerHTML = ''
        el.classList.add('no-comment')
      }
    })
  }

  const loadTwikoo = (el, path) => {
    if (typeof twikoo === 'object') setTimeout(() => init(el, path), 0)
    else btf.getScript('https://cdn.jsdelivr.net/npm/twikoo@1.6.44/dist/twikoo.all.min.js').then(() => init(el, path))
  }

  if (isShuoshuo) {
    'Twikoo' === 'Twikoo'
      ? window.shuoshuoComment = { loadComment: loadTwikoo }
      : window.loadOtherComment = loadTwikoo
    return
  }

  if ('Twikoo' === 'Twikoo' || !false) {
    if (false) btf.loadComment(document.getElementById('twikoo-wrap'), loadTwikoo)
    else loadTwikoo()
  } else {
    window.loadOtherComment = loadTwikoo
  }
})()</script></div><meting-js server="netease" type="playlist" id="570548381" fixed="true" autoplay="false" theme="#000000" loop="all" order="random" preload="auto" volume="0.7" muted="true" ></meting-js><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/aplayer@1.10.1/dist/APlayer.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/aplayer@1.10.1/dist/APlayer.min.js"></script><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.6/metingjs/dist/Meting.min.js"></script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div><!-- åªä¿ç•™è¿™ä¸€è¡Œ--><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">æœç´¢</span><i class="fas fa-spinner fa-pulse" id="loading-status" hidden="hidden"></i><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="text-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  æ•°æ®åŠ è½½ä¸­</span></div><div class="local-search-input"><input placeholder="æœç´¢æ–‡ç« ..." type="text"/></div><hr/><div id="local-search-results"></div><div class="ais-Pagination" id="local-search-pagination" style="display:none;"><ul class="ais-Pagination-list"></ul></div><div id="local-search-stats"></div></div><div id="search-mask"></div><script src="/js/search/local-search.js?v=5.5.3"></script></div></body></html>